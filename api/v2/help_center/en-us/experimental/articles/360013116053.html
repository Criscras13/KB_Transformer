<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Article 360013116053</title>
</head>
<body>
    <pre>{
  "id": 360013116053,
  "url": "https://Criscras13.github.io/KB_Transformer/site_src/static/api/v2/help_center/en-us/experimental/articles/360013116053.json",
  "html_url": "https://Criscras13.github.io/KB_Transformer/site_src/static/api/v2/help_center/en-us/experimental/articles/360013116053.html",
  "author_id": 360322304667,
  "comments_disabled": true,
  "draft": false,
  "promoted": false,
  "position": 0,
  "vote_sum": 12,
  "vote_count": 18,
  "section_id": 20416693775123,
  "created_at": "2018-12-03T16:00:32Z",
  "updated_at": "2025-05-13T17:50:18Z",
  "name": "YARA Rules Overview",
  "title": "YARA Rules Overview",
  "source_locale": "en-us",
  "locale": "en-us",
  "outdated": false,
  "outdated_locales": [],
  "edited_at": "2025-03-11T17:14:51Z",
  "user_segment_id": null,
  "permission_group_id": 195648,
  "content_tag_ids": [],
  "label_names": [
    "phisher",
    "PhishER",
    "YARA",
    "YARA rules",
    "yara",
    "phish er",
    "localized",
    "answerbot",
    "answerbot_phisher"
  ],
  "body": "<p>PhishER uses rules with Yet Another Recursive/Ridiculous Acronym (YARA) logic to disposition and tag the messages that are forwarded to your PhishER <strong>Inbox</strong>. <a href='https://yara.readthedocs.io/en/stable/' target='_blank' rel='noopener'>YARA</a> is a tool used to identify and classify malware samples. You can write <a href='https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/360013025854.html' target='_self'>custom rules</a> using YARA logic. For general information about creating rules in PhishER, see our <a href='https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/360013025854.html' target='_self'>How to Create and Manage PhishER Rules</a> article. To help you get started with YARA rules, see our list of common use cases and rules in our <a href='https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/360019622314.html'>Use Cases for YARA Rules</a> article.</p>\n<div class='callout-note'>\n<div class='callout__content'>\n<strong>Note:</strong>PhishER currently supports version 4.1.2 of YARA. For more information, see YARA's <a href='https://yara.readthedocs.io/en/v4.1.2/writingrules.html' target='_blank' rel='noopener'>Writing YARA rules</a> documentation.</div>\n</div>\n<h2 id='h_01HAQP30SBK6BTM343148WV7AN'>Using YARA Logic</h2>\n<p>A YARA rule is a logical expression with a description based on textual or binary patterns. A rule begins with a <strong>rule identifier</strong>, and a rule\u2019s description contains three sections: the meta, the strings, and the condition. These sections determine how a rule works.</p>\n<div class='callout-note'>\n<div class='callout__content'>\n<strong>Note:</strong>Use ASCII characters to write custom rules in PhishER. You cannot create a PhishER rule that contains non-ASCII characters. To learn more about ASCII characters, visit this <a href='https://www.ascii-code.com/' target='_blank' rel='noopener'>ASCII web page</a>.</div>\n</div>\n<h2 id='h_01HAQP30SBDHTCRMNHDG3V3X1C'>Rule Identifier</h2>\n<p>Start every YARA rule using the keyword <strong>rule</strong> followed by an <strong>identifier</strong>. An identifier is a unique name for your rule. Rule identifiers are case sensitive, cannot include spaces or start with a numerical value, and cannot include any of the keywords listed in YARA's <a href='https://yara.readthedocs.io/en/v4.1.2/writingrules.html#id3' target='_blank' rel='noopener'>Writing YARA Rules</a> documentation.</p>\n<div><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/YARARules/ruleIdentifier.png'><img src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/YARARules/ruleIdentifier.png' alt=' '></a></div>\n<h2 id='h_01HAQP30SB1NHQ6W4DEQMFYGWB'>Meta</h2>\n<p>Next, you can include a <strong>meta</strong> section to add comments or details about your rule. If you have multiple admins writing or editing YARA rules in PhishER, it can be helpful to use the <strong>meta</strong> section as an internal change log.</p>\n<div class='callout-note'>\n<div class='callout__content'>\n<strong>Note:</strong>The information provided in the meta section is not used for any variation of malware detection.</div>\n</div>\n<div><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/YARARules/meta.png'><img src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/YARARules/meta.png' alt=' '></a></div>\n<h2 id='h_01HAQP30SB0NQD5P6DPTV69JXX'>Strings</h2>\n<p>In the <strong>strings</strong> section, declare a variable and set its value. Each variable is indicated by the <strong>$</strong> sign followed by the variable name. Variables are case sensitive and cannot include spaces or start with a numerical value.</p>\n<div class='callout-note'>\n<div class='callout__content'>\n<strong>Note:</strong>If you\u2019re using a global variable in your rule, enter the value of the global variable in double brackets. You should enter the value as it is displayed in the rules list under <strong>Rules</strong> &gt; <strong>Global Variables</strong> in your PhishER platform. For more information about global variables, see the <a href='https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/360013025854.html' target='_self'>Using Global Variables</a> section of our <a href='https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/360013025854.html' target='_self'>How to Create and Manage PhishER Rules</a> article.</div>\n</div>\n<div><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/YARARules/strings.png'><img src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/YARARules/strings.png' alt=' '></a></div>\n<h2 id='h_01HAQP30SBA2KAN51QD5ADZAEG'>Condition</h2>\n<p>In the <strong>condition</strong> section, write an expression using logical operators to indicate what you would like your rule to detect. Every rule must have a <strong>condition</strong> section, and the condition must include all of your strings.</p>\n<div><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/YARARules/condition.png'><img src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/YARARules/condition.png' alt=' '></a></div>",
  "user_segment_ids": [],
  "source_url": "https://support.knowbe4.com/hc/en-us/articles/360013116053-YARA-Rules-Overview",
  "images": [
    {
      "url": "https://helpimg.s3.amazonaws.com/PhishER/Documentation/YARARules/ruleIdentifier.png",
      "alt": "The image displays a snippet from a text-based configuration file or source code editor, rendered with a dark gray background and light gray line numbers in the gutter.\n\n**UI Elements and Context:**\n*   **Environment:** Code editor interface utilizing syntax highlighting.\n*   **Gutter:** Displays line numbers (1 and 2) in light gray.\n*   **Focus/Highlighting:** The identifier `CEO_Fraud` on Line 1 is selected or under focus, indicated by yellow text on a yellow-green background highlight.\n\n**Text Content (Line by Line):**\n*   **Line 1:** `rule CEO_Fraud`\n    *   Defines a structure or function using the keyword `rule`, followed by the identifier `CEO_Fraud`.\n*   **Line 2:** `{`\n    *   An opening curly brace, indented, indicating the initiation of the rule block definition.\n\n**Technical Interpretation:** The structure suggests the commencement of a custom rule definition, likely within a security policy framework (e.g., YARA, SIEM, or custom detection engine) targeting Business Email Compromise (BEC) scenarios, indicated by the rule name `CEO_Fraud`.",
      "position": 1,
      "context": "target='_blank' rel='noopener'>Writing YARA Rules documentation."
    },
    {
      "url": "https://helpimg.s3.amazonaws.com/PhishER/Documentation/YARARules/meta.png",
      "alt": "This image displays a snippet of code, likely a YARA rule definition, within a text editor environment featuring syntax highlighting and line numbering (1 through 7).\n\n**UI and Context:**\nThe interface utilizes a dark background (charcoal) with light text for code visibility. A distinct block of code (Lines 3-6) is selected, indicated by a solid, dark yellow background highlighting the text within the block.\n\n**Code Content:**\n1.  **Line 1:** Defines the rule structure: `rule CEO_Fraud`\n2.  **Line 2:** Opens the rule block: `{`\n3.  **Line 3:** Initiates the metadata section (selected): `meta:`\n4.  **Line 4:** Metadata field: `author = \"Natalie\"`\n5.  **Line 5:** Metadata field: `date = \"11/06/2018\"`\n6.  **Line 6:** Metadata field: `description = \"This is a basic YARA rule for CEO fraud.\"`",
      "position": 2,
      "context": "n the meta section is not used for any variation of malware detection."
    },
    {
      "url": "https://helpimg.s3.amazonaws.com/PhishER/Documentation/YARARules/strings.png",
      "alt": "This image displays twelve lines of code defining a YARA rule within a dark-themed code editor environment.\n\n**Context and Structure:**\nThe rule is defined as `rule CEO_Fraud` (Line 1). Line numbers 1 through 12 are visible on the left margin.\n\n**Metadata Section (meta):**\nThe `meta` section (Lines 3-6) contains descriptive information:\n*   `author = \"Natalie\"`\n*   `date = \"11/06/2018\"`\n*   `description = \"This is a basic YARA rule for CEO fraud.\"`\n\n**Strings Section (strings):**\nThe `strings` block (Lines 8-11) is visually emphasized with a solid yellow background highlight. This section defines the patterns used for matching:\n*   **$text_a:** A text string, `\"wire transfer\"`.\n*   **$text_b:** A text string, `\"CEO\"`.\n*   **$hex:** A sequence of hexadecimal bytes: `{ E2 34 A1 C8 23 FB }`.",
      "position": 3,
      "context": "target='_self'>How to Create and Manage PhishER Rules article."
    },
    {
      "url": "https://helpimg.s3.amazonaws.com/PhishER/Documentation/YARARules/condition.png",
      "alt": "The image displays a snippet of code, lines 1 through 15, written in the YARA pattern matching signature language, presented within a dark-themed code editor environment featuring syntax highlighting and line numbering.\n\n**Context and Content:**\nThe code defines a rule named `CEO_Fraud`.\n\n1.  **Metadata Section (`meta`):** Contains descriptive attributes:\n    *   `author`: \"Natalie\"\n    *   `date`: \"11/06/2018\"\n    *   `description`: \"This is a basic YARA rule for CEO fraud.\"\n2.  **Strings Section (`strings`):** Defines three indicators for matching:\n    *   `$text_a`: The text string \"wire transfer\".\n    *   `$text_b`: The text string \"CEO\".\n    *   `$hex`: A sequence of hexadecimal bytes: `{ E2 34 A1 C8 23 FB }`.\n3.  **Condition Section (`condition`):** Specifies the detection logic.\n\n**UI Elements and Focus:**\nThe editor uses syntax highlighting (keywords in white/yellow, variables in yellow, strings enclosed in quotation marks). A block highlight, rendered as a solid yellow background, is applied to the `condition:` keyword (Line 13) and the condition logic (Line 14), `$text_a or $text_b or $hex`, indicating an active cursor location or a focus area within the code structure. The condition mandates a match if any of the three defined strings/hex patterns are present.",
      "position": 4,
      "context": "tion section, and the condition must include all of your strings."
    }
  ],
  "metadata": {
    "category": "",
    "section": "",
    "topics": [
      "overview",
      "rules",
      "yara"
    ],
    "image_count": 4
  }
}</pre>
</body>
</html>