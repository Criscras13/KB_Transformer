<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Article 7159083016723</title>
</head>
<body>
    <pre>{
  "id": 7159083016723,
  "url": "https://Criscras13.github.io/KB_Transformer/site_src/static/api/v2/help_center/en-us/experimental/articles/7159083016723.json",
  "html_url": "https://Criscras13.github.io/KB_Transformer/site_src/static/api/v2/help_center/en-us/experimental/articles/7159083016723.html",
  "author_id": 1915070258405,
  "comments_disabled": true,
  "draft": false,
  "promoted": false,
  "position": 0,
  "vote_sum": 3,
  "vote_count": 5,
  "section_id": 20416285489043,
  "created_at": "2022-06-21T15:03:07Z",
  "updated_at": "2025-05-27T14:58:53Z",
  "name": "Detection Rules Guide",
  "title": "Detection Rules Guide",
  "source_locale": "en-us",
  "locale": "en-us",
  "outdated": false,
  "outdated_locales": [],
  "edited_at": "2025-05-16T15:37:00Z",
  "user_segment_id": null,
  "permission_group_id": 195648,
  "content_tag_ids": [],
  "label_names": [
    "answerbot",
    "localizing",
    "securitycoach",
    "security coach",
    "Security Coach",
    "answerbot_securitycoach"
  ],
  "body": "<p>On the <strong>Detection Rules</strong> subtab of SecurityCoach, you can create and manage your detection rules. Detection rules identify what risky activity you want to track using the data provided by your integrated vendors. For example, you may want to detect when your users visit risky or prohibited websites, download malicious attachments, or click phishing links.</p>\n<p>We offer system detection rules based on integrated vendors\u2019 default policies. These rules are enabled by default and require no further configuration. To view available system detection rules, see our <a href='https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/11167145735955.html'>System Detection Rules by Vendor</a> article. You can also create custom detection rules for custom policies that you have set up in your vendors\u2019 platforms.</p>\n<p>If a user triggers a detection rule, an event will display on the user\u2019s timeline. You can also use detection rules to create real-time coaching campaigns.</p>\n<p>For general information about SecurityCoach, see our <a href='https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/6654432814355.html' target='_self'>SecurityCoach Product Manual</a>.</p>\n<h2 id='h_01HCJRY1QDEFH0779JKA6BDFAV'>Preparing for Detection Rules</h2>\n<p>Before you begin working with your detection rules, we recommend following the steps below:</p>\n<ol role='list'>\n<li>Integrate your third-party vendors with SecurityCoach. For more information, see our <a href='https://support.knowbe4.com/hc/en-us/sections/10969917980435-Setting-Up-Integrations'>Setting Up Integrations</a> section.</li>\n<li>Add a delivery method for your SecurityTips. For more information, see our vendor integration guides listed below:\n<ul role='list'>\n<li><a href='https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/7157869422099.html' target='_self'>Microsoft Teams Integration Guide for SecurityCoach</a></li>\n<li><a href='https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/7157787612819.html' target='_self'>Slack Integration Guide for SecurityCoach</a></li>\n<li><a href='https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/21452968565523.html'>Google Chat Integration Guide for SecurityCoach</a></li>\n</ul>\n</li>\n</ol>\n<h2 id='h_01HCJRY1QD6540CNS2HQJR7NMS'>Creating a Custom Detection Rule</h2>\n<p>To use custom detection rules in SecurityCoach, first set up a corresponding custom policy in a security vendor\u2019s platform. To work properly, custom detection rules must match the security vendor's custom policies.</p>\n<div class='callout-note'>\n<div class='callout__content'>\n<strong>Note:</strong>KnowBe4 support for custom detection rules is limited and does not include the creation of custom rules.</div>\n</div>\n<p>To create a custom detection rule, follow the steps below:</p>\n<ol role='list'>\n<li>Log in to your KnowBe4 Security Awareness Training (KSAT) console and navigate to the <strong>SecurityCoach</strong> tab &gt; <strong>Detection Rules </strong>subtab.</li>\n<li>Click the <strong>+ Create Detection Rule</strong> button at the top-right corner of the page.</li>\n<li>Fill out the fields on the <strong>Create New Detection Rule</strong> page. For more information about these fields, see the screenshot and list below:<br><img src='https://helpimg.s3.us-east-1.amazonaws.com/security_coach/DetectionRules_CreateDetectionRuleAnnotated.png'><br>\n<ol role='list' type='a'>\n<li>\n<p><strong>Name</strong>: Enter a name for your detection rule.</p>\n</li>\n<li>\n<strong>Enable Detection Rule:</strong> Select this check box to enable this rule when it is created. Detection rules must be enabled to add events to users\u2019 timelines and to be used for real-time coaching campaigns.</li>\n<li>\n<p><strong>Vendor</strong>: Select a vendor for your detection rule.</p>\n<div class='callout-note'>\n<div class='callout__content'>\n<strong>Note:</strong>You must integrate vendors with SecurityCoach before they can be displayed in this drop-down menu. The <strong>KSAT</strong> vendor is integrated by default. For more information about integrating vendors, see our <a href='https://support.knowbe4.com/hc/en-us/sections/10969917980435-Setting-Up-Integrations'>Setting Up Integrations</a> section.</div>\n</div>\n</li>\n<li>\n<p><strong>Category</strong>: Select a category for your detection rule.</p>\n</li>\n<li>\n<strong>Risk Level:</strong> Select a risk level for your detection rule.</li>\n<li>\n<p><strong>Description</strong>: Enter a description of your detection rule. For example, you could describe the purpose of the rule or include information that other admins may need to know about the rule.</p>\n</li>\n<li>\n<p><strong>New Criterion</strong>: Create a criterion for your detection rule using the three drop-down lists. Then, click <strong>Add Criterion</strong> to add the criterion to your detection rule. If you would like, you can repeat this process to add additional criteria for your detection rule. For more information about the operators that you can use for the criterion, see the <a href='#h_01HCJRY1QDQE926MS4FWVHZVDF'>Detection Rule Operators</a> section below.</p>\n</li>\n<li>\n<strong>Trigger this rule any time a user has a qualifying event:</strong> Select this option to trigger this rule any time an event meets the set criteria.</li>\n<li>\n<p><strong>Trigger this rule when a user meets the minimum count of qualifying events within the set duration (days)</strong>: Select this option to trigger this detection rule only when the criteria have been met a set number of times over a set number of days. For example, you can use this setting to trigger the detection rule for any users that have three qualifying events within 30 days.</p>\n<p>For more information about the <strong>Minimum Count</strong> and the <strong>Duration (Days)</strong> fields, see below:</p>\n<ul role='list'>\n<li>\n<strong>Minimum Count</strong>: Enter the minimum number of qualifying events that a user must have to trigger this rule.</li>\n<li>\n<strong>Duration (Days)</strong>: Enter the number of days a user has to meet the minimum count to trigger this rule.</li>\n</ul>\n</li>\n<li>\n<strong>Create Rule:</strong> Confirm your settings and create the new detection rule.</li>\n<li>\n<strong>Cancel:</strong> Cancel the creation of the detection rule and return to the prior page.</li>\n</ol>\n</li>\n<li>\n<p>Click <strong>Create Rule</strong>.</p>\n</li>\n</ol>\n<h3 id='h_01HCJRY1QDQE926MS4FWVHZVDF'><span>Detection Rule Operators</span></h3>\n<p>You can use the following operators when creating a detection rule criterion.</p>\n<div>\n<table>\n<thead>\n<tr>\n<th scope='col'>Operator</th>\n<th scope='col'>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Is</td>\n<td>This operator checks if the field and value match. You can enter only one value when using this operator.</td>\n</tr>\n<tr>\n<td>Is Not</td>\n<td>This operator checks if the field and value do not match. You can enter only one value when using this operator.</td>\n</tr>\n<tr>\n<td>Contains</td>\n<td>This operator checks if the field contains the value. You can enter only one value when using this operator.</td>\n</tr>\n<tr>\n<td>Does Not Contain</td>\n<td>This operator checks if the field does not contain the value. You can enter only one value when using this operator.</td>\n</tr>\n<tr>\n<td>Starts With</td>\n<td>This operator checks if the field starts with the value. You can enter only one value when using this operator.</td>\n</tr>\n<tr>\n<td>Ends With</td>\n<td>This operator checks if the field ends with the value. You can enter only one value when using this operator.</td>\n</tr>\n<tr>\n<td>Starts with Any Of</td>\n<td>This operator checks if the field starts with any of the values.</td>\n</tr>\n<tr>\n<td>Ends with Any Of</td>\n<td>This operator checks if the field ends with any of the values.</td>\n</tr>\n<tr>\n<td>Contains Any Of</td>\n<td>This operator checks if the field contains any of the values.</td>\n</tr>\n<tr>\n<td>Contains None Of</td>\n<td>This operator checks if the field contains none of the values.</td>\n</tr>\n<tr>\n<td>Is Any Of</td>\n<td>This operator checks if the field matches any of the values.</td>\n</tr>\n<tr>\n<td>Is None Of</td>\n<td>This operator checks if the field does not match any of the values.</td>\n</tr>\n</tbody>\n</table>\n</div>\n<h2 id='h_01HCJRY1QDV1KXMZRBE4S7GXT8'>Managing and Editing Detection Rules</h2>\n<p>To manage and edit your detection rules, navigate to the <strong>SecurityCoach</strong> tab &gt; <strong>Detection Rules </strong>subtab.</p>\n<p>To learn more about the options on the <strong>Detection Rules</strong> subtab, see the screenshot and list below:</p>\n<p><img src='https://helpimg.s3.us-east-1.amazonaws.com/security_coach/DetectionRules_TableAnnotated.png'></p>\n<ol class='alpha' role='list'>\n<li><span><strong>Status</strong>: Click this drop-down menu to filter detection rules by status. You can select <strong>All</strong>, <strong>Active</strong>, <strong>Inactive</strong>, or <strong>Maintenance</strong>.</span></li>\n<li><span><strong>Type</strong>: Click this drop-down menu to filter detection rules by type. You can select <strong>All</strong>, <strong>Custom</strong>, or <strong>System</strong>.</span></li>\n<li><span><strong>Vendors</strong>: Click this drop-down menu to filter detection rules by vendor.</span></li>\n<li><span><strong>Category</strong>: Click this drop-down menu to filter detection rules by category.</span></li>\n<li><span><strong>Search</strong>: Enter keywords in this field to search for a specific detection rule.</span></li>\n<li>Table: This table includes a list of your detection rules. For each detection rule, you can see the <strong>Name,</strong> <strong>Rule Description,</strong> <strong>Type,</strong> <strong>Vendor</strong>, <strong>Category,</strong> <strong>Modified Date,</strong> and <strong>Actions</strong> you can take.</li>\n<li><span>Toggle: Use this toggle to enable or disable a detection rule. If the toggle is turned off, the detection rule is disabled. If the toggle is turned on, the detection rule is enabled.</span></li>\n<li>\n<span><strong>Plus</strong> icon: Click this icon to create a real-time coaching campaign for a detection rule. When you click this icon, you will be taken to the Create New Real-Time Coaching Campaign page. For more information about real-time coaching campaigns, see our </span><a href='https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/7159255924371.html' target='_self'>Creating and Managing Real-Time Coaching Campaigns</a><span> article.</span>\n</li>\n<li><span><strong>Eye </strong>icon: Click this icon to view the system detection rule. When you click this icon, you will be taken to the <strong>View Detection Rule</strong> page, where you can view the details for the system detection rule.</span></li>\n<li>\n<strong>Plus</strong> icon: Click this icon to create a real-time coaching campaign for the detection rule. When you click this icon, you will be taken to the <strong>Create New Real-Time Coaching Campaign</strong> page. For more information about real-time coaching campaigns, see our <a href='https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/7159255924371.html'>Real-Time Coaching Campaigns Guide</a>.</li>\n<li>\n<strong>Three dots</strong> icon: Click this icon to open a drop-down menu with the following options:<br><img src='https://helpimg.s3.us-east-1.amazonaws.com/security_coach/DetectionRules_Table_ThreeDotsIcon.png' width='119' height='92'>\n<ul role='list'>\n<li>\n<p><strong>Edit:</strong> Click this icon to open the <strong>Edit Detection Rule</strong> page. On this page, you can edit a custom detection rule as needed. Options that are grayed out cannot be changed. Then, click the <strong>Save</strong> button at the bottom-left corner of the page to save your changes.</p>\n<div class='callout-note'>\n<div class='callout__content'>\n<strong>Note:</strong>If the detection rule was cloned from a system detection rule, you can also click the <strong>Restore Default Settings</strong> button to return the rule to its default settings.</div>\n</div>\n</li>\n<li>\n<p><strong>Clone:</strong> Click this icon to clone a system detection rule. When you click this icon, you will be taken to the <strong>Clone Detection Rule</strong> page. On this page, you can make changes to the rule and save it as a custom rule.</p>\n</li>\n<li>\n<p><strong>Delete:</strong> Click this icon to delete a custom detection rule.</p>\n</li>\n</ul>\n</li>\n<li>\n<strong>+ Create Detection Rule:</strong> Click this button to create a new detection rule.</li>\n</ol>\n<h2 id='h_01HCJRY1QD4GHB8WG5VW9BA4RW'>Example Detection Rule</h2>\n<p>See the screenshot below for an example of a detection rule:</p>\n<p><img src='https://helpimg.s3.us-east-1.amazonaws.com/security_coach/DetectionRules_ExampleDetectionRule.png'></p>\n<p>In this example, the following criteria were added to the detection rule:</p>\n<ul role='list'>\n<li>\n<strong>Threat Category</strong> is <strong>bulk forwarding by user</strong>.</li>\n<li>\n<strong>Threat Category</strong> is <strong>Suspicious email forwarding activity</strong>.</li>\n</ul>\n<p>This detection rule will be triggered when either criterion is met. Using this configuration, a user would need to either have suspicious email forwarding activity or be forwarding emails in bulk to trigger this rule.</p>",
  "user_segment_ids": [],
  "source_url": "https://support.knowbe4.com/hc/en-us/articles/7159083016723-Detection-Rules-Guide",
  "images": [
    {
      "url": "https://helpimg.s3.us-east-1.amazonaws.com/security_coach/DetectionRules_CreateDetectionRuleAnnotated.png",
      "alt": "This image displays the \"Create New Detection Rule\" interface, used for configuring security event detection parameters. The page is organized into three primary sections:\n\n1.  **Detection Rule Details:** Defines metadata and general settings for the rule.\n    *   **a (Name):** Text input field labeled \"Name\" with placeholder \"Enter a rule name...\".\n    *   **b (Enable Detection Rule):** A toggle switch labeled \"Enable Detection Rule,\" currently switched ON (blue).\n    *   **c (Vendor):** A dropdown menu labeled \"Vendor,\" pre-selected as \"KSAT.\"\n    *   **d (Category):** A dropdown menu labeled \"Category\" with placeholder \"Select a category...\".\n    *   **e (Risk Level):** A dropdown menu labeled \"Risk Level,\" pre-selected as \"Medium.\"\n    *   **f (Description):** A large text area labeled \"Description\" with placeholder \"Enter a description...\".\n\n2.  **Detection Rule Criteria:** Configures the conditions for rule triggering.\n    *   **g (New Criterion):** A set of input fields for defining criteria: a dropdown labeled \"New Criterion,\" a static text \"Is,\" and a dropdown with placeholder \"Select option,\" followed by an \"Add Criterion\" button (blue).\n\n3.  **Detection Rule Threshold:** Manages the frequency required for the rule to log an event or send an alert.\n    *   **h (Trigger option 1 - Default):** A radio button selected for \"Trigger this rule any time a user has a qualifying event.\"\n    *   **i (Trigger option 2 - Threshold):** A radio button for \"Trigger this rule when a user meets the minimum count of,\" followed by a number input set to \"50,\" the text \"qualifying events within,\" a number input set to \"10,\" and the unit \"days.\"\n\nThe top right corner includes a navigational link: \"\u2190 Back to Detection Rules.\"\n\nThe bottom of the page contains action buttons:\n*   **j (Create Rule):** A primary blue button labeled \"Create Rule.\"\n*   **k (Cancel):** A secondary gray button labeled \"Cancel.\"",
      "position": 1,
      "context": "For more information about these fields, see the screenshot and list below:"
    },
    {
      "url": "https://helpimg.s3.us-east-1.amazonaws.com/security_coach/DetectionRules_TableAnnotated.png",
      "alt": "The image displays the \"Detection Rules\" configuration page within a web application interface, dedicated to managing security event detection rules used for real-time coaching campaigns.\n\n**I. Header and Navigation:**\n\n*   The page title is **Detection Rules**.\n*   A top navigation menu includes tabs: Dashboard, Real-Time Coaching, **Detection Rules** (active tab), SecurityTips, Setup, and Reports.\n*   Contextual text beneath the header describes the page's function: \"Your library of detection rules. Add detection rules to real-time coaching campaigns to send users immediate feedback when risky behavior is detected.\"\n\n**II. Control Panel (Filters and Actions):**\n\nA row of controls allows filtering and searching:\n*   (a) **Status Filter:** Dropdown menu set to \"All.\"\n*   (b) **Type Filter:** Dropdown menu set to \"All.\"\n*   (c) **Vendors Filter:** Dropdown menu set to \"All.\"\n*   (d) **Category Filter:** Dropdown menu set to \"All.\"\n*   (e) **Search Field:** Text input labeled \"Search\" with a magnifying glass icon.\n*   (k) **Primary Action Button:** A blue button labeled **+ Create Detection Rule**.\n\n**III. Data Table (Detection Rules List):**\n\nThe main content is a data table listing defined detection rules.\n\n**Column Headers (f):**\n*   Name\n*   Rule Description\n*   Type\n*   Vendor\n*   Category\n*   Modified Date (Sorted, indicated by an upward/downward arrow icon)\n*   Actions (i)\n\n**Sample Data Row 1 (Top entry):**\n*   (g) **Status:** An active blue toggle switch indicates the rule is enabled.\n*   **Name:** Enabled Macros Detected by KMSAT (hyperlinked).\n*   **Rule Description:** User enabled macros for attachments from a phishing email.\n*   **Type:** System.\n*   **Vendor:** KSAT.\n*   **Category:** Email Safety.\n*   (h) **Modified Date:** 10/03/2024.\n*   (i/j) **Actions:** A button group containing three icons: an eye icon (View/Details), a plus sign icon (Add), and a vertical ellipsis (More Options/Context menu).\n\n**Subsequent Rules (Examples):**\nThe table lists three other system rules detected by KMSAT, categorized under \"Phishing,\" including rules for \"QR Code Scan,\" \"Phishing Email Reply,\" and \"Opened Attachment.\" All displayed rules are active and show action buttons for view, add, and more options.",
      "position": 2,
      "context": ">SecurityCoach tab > Detection Rules subtab.\nTo learn more about the options on the Detection Rules "
    },
    {
      "url": "https://helpimg.s3.us-east-1.amazonaws.com/security_coach/DetectionRules_Table_ThreeDotsIcon.png",
      "alt": "The image displays a user interface component, specifically a vertically aligned menu fragment or dropdown, presenting three distinct action options. Each option consists of a dark-toned icon followed by its descriptive text label:\n\n1.  **Edit**: Represented by a pencil or stylus writing on a document icon.\n2.  **Clone**: Represented by two overlapping document icons, signifying duplication.\n3.  **Delete**: Represented by an outline of a trash can icon.\n\nThe component utilizes clear text labels and standard iconography to define core record or item management operations (modification, duplication, and removal).",
      "position": 3,
      "context": "p_center/en-us/articles/7159255924371.html'>Real-Time Coaching Campaigns Guide.\n\nThree dots icon: Cl"
    },
    {
      "url": "https://helpimg.s3.us-east-1.amazonaws.com/security_coach/DetectionRules_ExampleDetectionRule.png",
      "alt": "This image displays the interface for creating a new security detection rule, titled \"Create New Detection Rule.\" A navigation link \"\u2190 Back to Detection Rules\" is visible in the top right corner. The form is divided into three main sections.\n\n**1. Detection Rule Details**\nThis section defines the basic attributes of the rule:\n*   **Name:** Populated with \"Suspicious Email Forwarding Detect.\"\n*   **Enable Detection Rule:** A toggle switch is enabled (ON).\n*   **Vendor:** A dropdown menu set to \"Microsoft 365.\"\n*   **Category:** A dropdown menu set to \"Email Safety.\"\n*   **Risk Level:** A dropdown menu set to \"Medium.\"\n*   **Description:** A text area containing the text \"Suspicious email forwarding was detected.\"\n\n**2. Detection Rule Criteria**\nThis section defines the event matching logic:\n*   **Matching Logic:** A radio button selection where \"Any criterion\" is selected over \"All criteria.\"\n*   **New Criterion Builder:** Displays three empty input controls/dropdowns (initially \"Threat Category,\" \"Is,\" and \"Select option\") followed by an \"Add Criterion\" button.\n*   **Existing Criteria:** Two criteria are already defined, each with a dismissible 'X' button:\n    *   \"Threat Category Is bulk forwarding by user\"\n    *   \"Threat Category Is Suspicious email forwarding activity\"\n\n**3. Detection Rule Threshold**\nThis section controls how frequently the rule must trigger:\n*   **Threshold Options (Radio Buttons):**\n    *   The default option, \"Trigger this rule any time a user has a qualifying event,\" is selected.\n    *   The secondary option, \"Trigger this rule when a user meets the minimum count of [50] qualifying events within [10] days,\" is visible but deselected, with integer values '50' and '10' entered into respective text fields.\n\n**Action Buttons**\nAt the bottom of the page, two action buttons are presented: \"Create Rule\" (primary, blue) and \"Cancel\" (secondary, gray).",
      "position": 4,
      "context": "> Click this button to create a new detection rule.\n\nExample Detection Rule\nSee the screenshot below"
    }
  ],
  "metadata": {
    "category": "",
    "section": "",
    "topics": [
      "detection",
      "rules"
    ],
    "image_count": 4
  }
}</pre>
</body>
</html>