<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Article 4404511190803</title>
</head>
<body>
    <pre>{
  "id": 4404511190803,
  "url": "https://Criscras13.github.io/KB_Transformer/site_src/static/api/v2/help_center/en-us/experimental/articles/4404511190803.json",
  "html_url": "https://Criscras13.github.io/KB_Transformer/site_src/static/api/v2/help_center/en-us/experimental/articles/4404511190803.html",
  "author_id": 1501549449361,
  "comments_disabled": true,
  "draft": false,
  "promoted": false,
  "position": 4,
  "vote_sum": 42,
  "vote_count": 62,
  "section_id": 26244236265875,
  "created_at": "2021-07-30T18:35:56Z",
  "updated_at": "2025-11-26T20:07:27Z",
  "name": "Advanced Delivery Policies in Microsoft Defender for Office 365",
  "title": "Advanced Delivery Policies in Microsoft Defender for Office 365",
  "source_locale": "en-us",
  "locale": "en-us",
  "outdated": false,
  "outdated_locales": [],
  "edited_at": "2025-11-26T20:07:27Z",
  "user_segment_id": null,
  "permission_group_id": 195648,
  "content_tag_ids": [],
  "label_names": [
    "answerbot",
    "localizing",
    "adp",
    "advanced delivery",
    "microsoft defender",
    "answerbot_kmsat"
  ],
  "body": "<p>In this article, you'll learn how to whitelist KnowBe4 using advanced delivery policies, Microsoft's recommended method for whitelisting our Phishing Security Tests (PSTs). If you prefer video tutorials, you can also watch our <a href='https://support.knowbe4.com/hc/en-us/articles/4413978898707'>Whitelisting by Advanced Delivery Policies in Microsoft 365</a> video. For more information, see Microsoft's article on <a href='https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/advanced-delivery-policy-configure?view=o365-worldwide' target='_blank' rel='noopener noreferrer'>advanced delivery policies</a>.</p>\n<div class='callout-remember'>\n<div>\n<strong>Important:</strong>Some whitelisting configurations may not be available in environments outside of the US.</div>\n</div>\n<p>If your messages still aren\u2019t delivering after configuring your advanced delivery policy, we recommend setting up <a href='https://support.knowbe4.com/hc/en-us/articles/360000568187'>smart hosting</a>. Without smart hosting, some filters cannot be disabled, which may impact the delivery of PSTs. Smart hosting PSTs allow you to bypass these filters.</p>\n<div class='callout-tip'>\n<div>\n<strong>Tip:</strong>If any of your domains\u2019 mail exchange (MX) records point to a Secure Email Gateway (SEG), combine Microsoft Defender's advanced delivery policies with a dedicated smart host for the most reliable whitelisting. These two items are designed to bypass both aggressive third-party security gateways and native Microsoft 365 filtering, ensuring the seamless delivery of simulated phishing and training content.</div>\n</div>\n<p>To configure your advanced delivery policies, you'll need to ensure you have the appropriate permissions in your Microsoft 365 account and settings in your KnowBe4 account.</p>\n<div class='callout-note'>\n<div>\n<strong>Note:</strong>Before you can configure your advanced delivery policies, you\u2019ll need to copy up to 30 phish link root domains you currently use or plan to use for PSTs from the <strong>Root Domain </strong>column in the <strong>Domains </strong>subtab in your KnowBe4 console and save these in a place you can access later. We also recommend you hide any root domains you\u2019re not using in your advanced delivery policies. For more information, see our <a href='https://support.knowbe4.com/hc/en-us/articles/360061705153'>Manage Phish Link Domains</a> article.</div>\n</div>\n<h2 id='h_01HT2Q1WVN892RMXJ1Z9SG9BSE'>Update Your Microsoft 365 Permissions</h2>\n<p>To create, modify, or remove settings in an advanced delivery policy, you\u2019ll need to be a member of the <strong>Security Administrator</strong> role group in the Microsoft Security &amp; Compliance Center and the <strong>Organization Management</strong> role group in Microsoft Exchange Online.</p>\n<p>For read-only access to an advanced delivery policy, you\u2019ll need to be a member of the <strong>Global Reader</strong> or <strong>Security Reader</strong> role groups. For more information about Microsoft permissions, see Microsoft\u2019s <a href='https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/permissions-microsoft-365-security-center?view=o365-worldwide' target='_blank' rel='noopener noreferrer'>Permissions in the Microsoft 365 Defender portal</a> and <a href='https://docs.microsoft.com/en-us/exchange/permissions-exo/permissions-exo' target='_blank' rel='noopener noreferrer'>Permissions in Exchange Online</a> articles.</p>\n<div class='callout-remember'>\n<div>\n<strong>Important:</strong>For best results with your phishing campaigns, we also suggest adding KnowBe4 to your domain's Sender Policy Framework (SPF) record to mitigate concerns about reverse lookups and spoofing. For more information, see our <a href='https://support.knowbe4.com/hc/en-us/articles/115003254328'>Add KnowBe4 to Your Sender Policy Framework (SPF) Record</a> article.</div>\n</div>\n<h2 id='h_01HT2Q2J8PX59EMT1TM0J3NP5S'>Update Your KnowBe4 Account Settings</h2>\n<p>To configure an advanced delivery policy for KnowBe4, you\u2019ll need to first update your DKIM settings in your KnowBe4 account by following the steps below.</p>\n<div class='callout-remember'>\n<div>\n<strong>Important:</strong>If you're using the free PST, contact our support team for a list of phishing domains.</div>\n</div>\n<ol>\n<li>Log in to your KnowBe4 account, then navigate to <strong>Account Settings</strong> &gt; <strong>Phishing</strong> &gt; <strong>Phishing Settings</strong>.</li>\n<li>In the <strong>Phishing Email Headers</strong> section, select the <strong>Enable DKIM Signature</strong> check box.</li>\n<li>Ensure the <strong>Use KnowBe4's Signing Domain</strong> setting is selected.</li>\n<li>Click <strong>Save DKIM Settings</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/KMSAT/Account_Settings/Phishing/Phishing-Settings/EN/EnableDKIMSignature.png'><img src='https://helpimg.s3.amazonaws.com/KMSAT/Account_Settings/Phishing/Phishing-Settings/EN/EnableDKIMSignature.png' alt=' '></a></p>\n</li>\n</ol>\n<h2 id='h_01HBE1BQDRF32S67HJYB1XXNXX'>Add Your Advanced Delivery Policy</h2>\n<p>To add your advanced delivery policy, follow the steps below:</p>\n<ol>\n<li>Log in to your Microsoft 365 account.</li>\n<li>From the menu on the left side of the page, select <strong>Admin</strong>. You'll be taken to the Microsoft 365 admin center.</li>\n<li>Navigate to <strong>Admin centers </strong>&gt;<strong> Security</strong>. Or, you can directly log in to your <a href='https://security.microsoft.com/homepage' target='_blank' rel='noopener noreferrer'>Microsoft 365 Defender portal</a>.</li>\n<li>Under the <strong>Email &amp; collaboration </strong>section, navigate to <strong>Policies &amp; rules</strong> &gt; <strong>Threat policies</strong> &gt; <strong>Advanced delivery</strong>.</li>\n<li>On the <strong>Advanced delivery</strong> page, select the <strong>Phishing Simulation</strong> tab.</li>\n<li>Click the <strong>Edit</strong> icon.\n<div class='callout-remember'>\n<div>\n<strong>Important:</strong>If you don't have any configured phishing simulations, click the <strong>Add </strong>icon.</div>\n</div>\n</li>\n<li>In the <strong>Edit third-party phishing simulation</strong> modal, adjust the following settings. You should use the settings for your specific region:\n<ol type='a'>\n<li>\n<strong>Domain: </strong>Enter the sending domains for your specific region using the table below.\n<table style='margin-block-start: 1.5rem;'>\n<thead>\n<tr>\n<th scope='col'>Region</th>\n<th scope='col'>Domain</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th rowspan='2' scope='rowgroup'>training.knowbe4.com</th>\n<td>psm.knowbe4.com</td>\n</tr>\n<tr>\n<td>ispservices.org</td>\n</tr>\n<tr>\n<th rowspan='2' scope='rowgroup'>eu.knowbe4.com</th>\n<td>psm.knowbe4.com</td>\n</tr>\n<tr>\n<td>ispservices.co.uk</td>\n</tr>\n<tr>\n<th rowspan='2' scope='rowgroup'>ca.knowbe4.com</th>\n<td>psm.knowbe4.com</td>\n</tr>\n<tr>\n<td>ispservices.net</td>\n</tr>\n<tr>\n<th rowspan='2' scope='rowgroup'>uk.knowbe4.com</th>\n<td>psm.knowbe4.com</td>\n</tr>\n<tr>\n<td>online-login-portal.com</td>\n</tr>\n<tr>\n<th rowspan='2' scope='rowgroup'>de.knowbe4.com</th>\n<td>psm.knowbe4.com</td>\n</tr>\n<tr>\n<td>mailserver-status.com</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>\n<strong>Sending IP</strong>: Enter the sending IP addresses for your specific region using the table below.\n<table style='margin-block-start: 1.5rem;'>\n<thead>\n<tr>\n<th scope='col'>Region</th>\n<th scope='col'>IP Addresses</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th rowspan='3' scope='rowgroup'>training.knowbe4.com, ca.knowbe4.com, uk.knowbe4.com, de.knowbe4.com</th>\n<td>147.160.167.0/26</td>\n</tr>\n<tr>\n<td>23.21.109.197</td>\n</tr>\n<tr>\n<td>23.21.109.212</td>\n</tr>\n<tr>\n<th rowspan='5' scope='rowgroup'>eu.knowbe4.com</th>\n<td>147.160.167.0/26</td>\n</tr>\n<tr>\n<td>52.49.201.246</td>\n</tr>\n<tr>\n<td>52.49.235.189</td>\n</tr>\n<tr>\n<td>23.21.109.197</td>\n</tr>\n<tr>\n<td>23.21.109.212</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>\n<strong>Simulation URLs to allow</strong>: Paste your phish link root domains you copied earlier from the <a href='https://support.knowbe4.com/hc/en-us/articles/360061705153'><strong>Root Domain</strong></a> column in your KnowBe4 console. Adjust the format to the recommended URL format syntax: <strong>*.example.com/*</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/O365_Whitelisting/O365_ADP.png'><img src='https://helpimg.s3.amazonaws.com/O365_Whitelisting/O365_ADP.png' alt=' ' width='509' height='792'></a></p>\n</li>\n</ol>\n</li>\n<li>(Optional) To spoof your domain or to use spoofing in the delivery of PSTs, you will need to add the spoof intelligence policy from our <a href='https://support.knowbe4.com/hc/en-us/articles/4404513628051'>Spoof Intelligence Allow/Block List for Microsoft 365</a> article.</li>\n</ol>\n<div class='callout-tip'>\n<div>\n<strong>Tip:</strong>To ensure that you have whitelisted correctly, see our <a href='https://support.knowbe4.com/hc/en-us/articles/1500007900421'>Verify Your Whitelisting</a> article.</div>\n</div>",
  "user_segment_ids": [],
  "source_url": "https://support.knowbe4.com/hc/en-us/articles/4404511190803-Advanced-Delivery-Policies-in-Microsoft-Defender-for-Office-365",
  "images": [
    {
      "url": "https://helpimg.s3.amazonaws.com/KMSAT/Account_Settings/Phishing/Phishing-Settings/EN/EnableDKIMSignature.png",
      "alt": "The image displays the \"Phishing Email Headers\" configuration section within a security platform UI.\n\n**Upper Configuration Area (Checkboxes):**\nThe top section lists four optional, currently unchecked header configuration controls, each accompanied by a question mark (help) icon:\n1.  Overwrite Fixed Return-path Address with Sender Address\n2.  Disable X-PHISHTEST Header\n3.  Enable PST Header Token\n4.  Add Custom Header\n\n**Active DKIM Configuration Panel (Highlighted):**\nThe primary focus is the active panel for DKIM configuration, indicated by the checked status of the main control: `Enable DKIM Signature`.\n\nWithin this active panel, two domain selection options are presented:\n*   **Selected Option (Button):** `Use KnowBe4's Signing Domain` (Highlighted in blue).\n*   **Alternate Option (Link):** `Use Your Own Signing Domain`.\n\nBelow the selection options is descriptive text:\n1.  **Description:** \"Enable this option to add a DKIM signature to PST emails, using KnowBe4's signing domain.\"\n2.  **Status/Technical Detail:** \"The DKIM signing domain is **ispservices.org**, the selector is **15dd344475d0f54a**.\" (The domain and selector values are highlighted in a magenta color.)\n\nThe section concludes with a primary action button: `Save DKIM Settings`. All primary configuration labels and buttons feature a question mark (help) icon.",
      "position": 1,
      "context": "i>\nClick Save DKIM Settings."
    },
    {
      "url": "https://helpimg.s3.amazonaws.com/O365_Whitelisting/O365_ADP.png",
      "alt": "This image displays a dialog box titled **\"Edit third party phishing simulations\"** used for configuring security settings related to allowing simulated phishing attacks.\n\nThe main text describes the purpose: Phishing simulations are used for security training, and third-party simulations require configuration of **Sending domain** and **Sending IP** entries for message delivery. It also notes that the **Simulation URLs to allow** field is optional, ensuring associated URLs are not blocked during click-time, particularly in scenarios using Microsoft Teams and Office apps.\n\nBelow the explanatory text, three configuration sections are present, each featuring a multiple-entry input field:\n\n1.  **Domain (2 items)**: This section lists two allowed sending domains, presented as tagged entries: **psm.knowbe4.com** and **ispservices.org**.\n2.  **Sending IP (3 items)**: This section lists three IP addresses/CIDR ranges: **147.160.167.0/26**, **23.21.109.197**, and **23.21.109.212**.\n3.  **Simulation URLs to allow (3 items)**: This section lists three allowed URLs/wildcards, each formatted as a blue tag: **\\*.example.com/\\* \\**, **\\*.kb4.io/\\* \\**, and **\\*.phishing.guru/\\* \\**.\n\nThe dialog concludes with two action buttons at the bottom: a primary blue button labeled **Save** and a secondary gray button labeled **Cancel**.",
      "position": 2,
      "context": "Adjust the format to the recommended URL format syntax: *.example.com/*."
    }
  ],
  "metadata": {
    "category": "Security Awareness Training",
    "section": "Microsoft",
    "topics": [
      "advanced",
      "awareness",
      "defender",
      "delivery",
      "microsoft",
      "office",
      "policies",
      "security",
      "training"
    ],
    "image_count": 2
  }
}</pre>
</body>
</html>