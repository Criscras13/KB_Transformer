<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Article 5635049737107</title>
</head>
<body>
    <pre>{
  "id": 5635049737107,
  "url": "https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/experimental/articles/5635049737107.json",
  "html_url": "https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/experimental/articles/5635049737107.html",
  "author_id": 1915070258405,
  "comments_disabled": true,
  "draft": false,
  "promoted": false,
  "position": 3,
  "vote_sum": 3,
  "vote_count": 3,
  "section_id": 20416693775123,
  "created_at": "2022-04-19T19:31:17Z",
  "updated_at": "2025-05-13T17:50:18Z",
  "name": "Create Strings and Conditions in the YARA Rule Basic Editor",
  "title": "Create Strings and Conditions in the YARA Rule Basic Editor",
  "source_locale": "en-us",
  "locale": "en-us",
  "outdated": false,
  "outdated_locales": [],
  "edited_at": "2025-03-11T17:49:48Z",
  "user_segment_id": null,
  "permission_group_id": 195648,
  "content_tag_ids": [],
  "label_names": [
    "localized",
    "answerbot",
    "strings",
    "conditions",
    "rules",
    "basic editor",
    "answerbot_phisher"
  ],
  "body": "<p>All PhishER <a href='https://support.knowbe4.com/hc/en-us/articles/360013025854'>rules</a> must follow Yet Another Recursive/Ridiculous Acronym (YARA) rule logic to disposition messages. In your PhishER platform, you can use the Basic Editor to create strings and conditions for your YARA rules instead of writing all of the YARA rule logic manually.</p>\n<p>For more information about writing YARA rules, visit our <a href='https://support.knowbe4.com/hc/en-us/articles/360013116053' target='_self'>How to Write YARA Rules</a> article.</p>\n\n\n<p>You can create a string by declaring a variable and then setting a value for that variable. In the Basic Editor, each new string contains a preset variable, and you must enter a value for that variable.</p>\n<p>To create strings in the Basic Editor, follow the steps below:</p>\n<ol role='list'>\n<li>Log in to your PhishER platform.</li>\n<li>From the sidebar on the left side of the page, select the <strong>Rules</strong>\u00a0tab to open the <strong>Rules List</strong> page.</li>\n<li>Click the <strong>New Rule</strong> button at the top-right corner of the page to open\u00a0the <strong>Rule Details</strong> page.</li>\n<li>Complete the top section of the <strong>Rule Details</strong> page. For more information about the fields on this page, visit our <a href='https://support.knowbe4.com/hc/en-us/articles/360013025854' target='_self'>How to Create and Manage PhishER Rules</a> article.</li>\n<li>In the <strong>Create Strings</strong> section, enter a value for the string.\n<div class='callout-note'><div class='callout__content'>\n<strong>Note:</strong>Values must include ASCII characters only. For more information about ASCII characters, visit this <a href='https://www.ascii-code.com/' target='_blank' rel='noopener noreferrer'>ASCII</a> web page.</div></div>\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createstrings_firststring.png'><img src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createstrings_firststring.png' alt=' '></a></p>\n</li>\n<li>(Optional) If you would like to use a global variable, click the <strong>globe</strong> drop-down icon. From the drop-down menu that opens, select the name of the global variable you want to use. For more information about global variables, see the <a href='https://support.knowbe4.com/hc/en-us/articles/360013025854#GLOBAL' target='_self'>Using Global Variables</a> section of our <a href='https://support.knowbe4.com/hc/en-us/articles/360013025854' target='_self'>How to Create and Manage PhishER Rules</a> article.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createstring_GlobalVariable.png'><img src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createstring_GlobalVariable.png' alt=' '></a></p>\n</li>\n<li>(Optional) If you would like to create additional strings, click the <strong>New String</strong> button. Then, enter values for the new strings.\n<div class='callout-note'><div class='callout__content'>\n<strong>Note:</strong>You can create up to five strings for each rule.</div></div>\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createstrings_secondstring.png'><img src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createstrings_secondstring.png' width='478' height='281' alt=' '></a></p>\n</li>\n</ol>\n<p>Once you've created at least one string, you'll need to create conditions for your rule. For more information, visit the section of this article below.</p>\n\n\n\n<p>After you create at least one string, you can create conditions for your rule. Conditions allow you to specify what messages you want your rule to affect. When you create conditions for your rule, you can choose from three options. For more information about these options, see the screenshot and list below:<a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/PhishER/Rules/RuleDetails/EN/CreateConditions.png'><img src='https://helpimg.s3.amazonaws.com/PhishER/Rules/RuleDetails/EN/CreateConditions.png' alt=' '></a></p>\n\n<ol type='a' role='list'>\n<li>\n<strong>Match any of the defined strings</strong>: Select this option to detect messages that match any of your defined strings.</li>\n<li>\n<strong>Match all of the defined strings</strong>: Select this option to detect messages that match all of your defined strings.</li>\n<li>\n<strong>Custom conditions</strong>: Select this option to detect messages that match your custom conditions. For more information about custom conditions, visit the subsection of this article below.</li>\n</ol>\n\n\n<h2 id='h_01H96SKA8JAVRSVC3CAETWG269'>Creating Custom Conditions in the Basic Editor</h2>\n<p>You can create up to five custom conditions for each rule. To create custom conditions, write expressions using your strings and logical operators. When you create custom conditions, you must use all of the strings you created for the rule.</p>\n<p>To create a custom condition, follow the steps below:</p>\n<ol role='list'>\n<li>On the <strong>Rule Details</strong> page, create the <a href='#h_01H96SKA8HRFKJPXP5HZSVMAAN'>strings</a> that you need for your custom condition.</li>\n<li>In the <strong>Create Conditions</strong> section of the page, select <strong>Custom conditions</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createconditions_customconditions.png'><img src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createconditions_customconditions.png' width='504' height='295' alt=' '></a></p>\n</li>\n<li>From the <strong>Choose string</strong> drop-down menu, select one of the strings you created.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createconditions_customconditions_choosestring.png'><img src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createconditions_customconditions_choosestring.png' width='509' height='270' alt=' '></a></p>\n</li>\n<li>To add another string to the condition, click the\u00a0<strong>Add</strong> drop-down menu.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createconditions_addsecondstring.png'><img src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createconditions_addsecondstring.png' width='515' height='74' alt=' '></a></p>\n</li>\n<li>From the <strong>Add</strong> drop-down menu, select one of the options listed below:\n<ul role='list'>\n<li>\n<strong>and</strong>: Select this option if the rule should detect messages that match both strings.</li>\n<li>\n<strong>or</strong>: Select this option if the rule should detect messages that match either strings or both strings.</li>\n<li>\n<strong>and not</strong>: Select this option if the rule should detect messages that match the existing string but do not match the string being added.</li>\n</ul>\n</li>\n<li>After you select an option from the <strong>Add</strong> drop-down menu, the <strong>Choose string</strong> drop-down menu will display. From this drop-down menu, select a string.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createconditions_choosesecondstring.png'><img src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createconditions_choosesecondstring.png' width='525' height='280' alt=' '></a></p>\n</li>\n<li>Repeat steps 4-6 until you have added all the strings that you need for the condition.</li>\n</ol>\n\n<p>After you have created your first condition, you can create up to four additional conditions for your rule. To create a new condition, follow the steps below:</p>\n<ol role='list'>\n<li>To add another condition, click the <strong>New Condition Group</strong> drop-down menu.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createconditions_newconditiongroup_button.png'><img src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createconditions_newconditiongroup_button.png' width='591' height='137' alt=' '></a></p>\n</li>\n<li>From the drop-down menu, select one of the options listed below:\n<ul role='list'>\n<li>\n<strong>and</strong>: Select this option if the rule should detect messages that match both conditions.</li>\n<li>\n<strong>or</strong>: Select this option if the rule should detect messages that match either or both conditions.</li>\n<li>\n<strong>and not</strong>: Select this option if the rule should detect messages that match the existing condition but do not match the condition you are adding.</li>\n</ul>\n</li>\n<li>In the new condition section, select the strings needed for your condition and select how they should relate to each other.</li>\n<li>Repeat steps 1-3 until you have added all the conditions that you need for the rule.</li>\n<li>Click <strong>Save Rule</strong> to save your rule.</li>\n</ol>\n\n<p>To view an example of custom conditions, see the screenshot and details below:<a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/example_customconditions.png'><img src='https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/example_customconditions.png' alt=' '></a></p>\n\n<p>In this screenshot, the following three strings were created: \u201c.pdf\u201d, \u201c.htm\u201d, and \u201c.exe\u201d. The three strings were used to create two custom conditions that must be met for the rule to detect a message. To be detected by this rule, a message would need to either include both \u201c.pdf\u201d and \u201c.htm\u201d or include \u201c.exe\u201d only.</p>\n",
  "user_segment_ids": [],
  "source_url": "https://support.knowbe4.com/hc/en-us/articles/5635049737107-Create-Strings-and-Conditions-in-the-YARA-Rule-Basic-Editor",
  "images": [
    {
      "url": "https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createstrings_firststring.png",
      "alt": "This image displays the **Basic Editor** tab within a rule or condition configuration interface. The adjacent, inactive tab is labeled **Advanced Editor**.\n\n**Section: Create Strings**\nThe main heading is \"Create Strings.\" Instructional text states: \"Create values for each string to use them when creating conditions.\"\n\nOne string definition input row is visible:\n1.  A constant labeled **$string\\_1** (in a rounded token).\n2.  An equals sign (`=`).\n3.  A quotation mark (`\"`).\n4.  A text input field with placeholder text **enter value here**.\n5.  A closing quotation mark (`\"`).\n6.  An orange button containing a globe icon and a dropdown arrow, indicating a context or localization option.\n\nBelow the string definition is an orange button labeled **New String**, used to add additional variables.\n\n**Action Footer**\nAt the bottom of the interface, two primary action buttons are present:\n1.  **Save Rule** (Faded orange/pink, indicating a potentially inactive or secondary action state).\n2.  **Apply Rule to Inbox** (White with an orange outline).",
      "position": 1,
      "context": "rel='noopener noreferrer'>ASCII web page."
    },
    {
      "url": "https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createstring_GlobalVariable.png",
      "alt": "This image depicts a user interface for defining custom string variables for conditional logic.\n\n**Context and Header:** The section is titled \"Create Strings,\" followed by the instruction: \"Create values for each string to use them when creating conditions.\"\n\n**String Definition Interface:** A single key-value input field is visible:\n1.  **String Key/Variable:** A pill-shaped container identifies the variable name as \"$\\text{string\\_1}$\".\n2.  **String Value Input:** An input field follows the equals sign, currently displaying the value \"[[Tester]]\". This field includes a visible 'X' icon for clearing the input.\n3.  **Localization Control:** To the right of the input field is an orange button featuring a globe icon and a downward chevron, indicating localization or language-specific string management options.\n\n**Contextual Overlay:** An active, orange contextual dropdown menu is shown originating from the string value input area. This menu displays a single, focused option labeled \"**Tester**,\" which includes a cursor/hand icon, suggesting that this option is currently being selected or is the source of the \"[[Tester]]\" input.\n\n**Action Button:** A main action button is present at the bottom left, labeled \"**New String**.\"",
      "position": 2,
      "context": "elf'>How to Create and Manage PhishER Rules article."
    },
    {
      "url": "https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createstrings_secondstring.png",
      "alt": "A user interface segment titled \"**Create Strings**\" is displayed, designed for defining string variables and their values for use in conditional logic.\n\n**Contextual Text:**\nBelow the main title is the descriptive text: \"Create values for each string to use them when creating conditions.\"\n\n**String Definition Section:**\nThe section contains two defined string variables:\n\n1.  **String 1:**\n    *   Variable Name (Encapsulated in an oval gray pill): `$string_1`\n    *   Assignment Operator: `=`\n    *   Value Input Field: Contains the text `.pdf` (preceded and followed by quotation marks: `\".pdf\"`).\n    *   Configuration Button: An orange button featuring a globe icon and a downward-facing caret (dropdown indicator).\n    *   Removal Icon: A gray 'x' icon to the far right.\n\n2.  **String 2:**\n    *   Variable Name (Encapsulated in an oval gray pill): `$string_2`\n    *   Assignment Operator: `=`\n    *   Value Input Field: Contains the placeholder text `enter value here` (preceded and followed by quotation marks: `\"`).\n    *   Configuration Button: An orange button featuring a globe icon and a downward-facing caret (dropdown indicator).\n    *   Removal Icon: A gray 'x' icon to the far right.\n\n**Action Button:**\nAt the bottom left, there is a prominent, rectangular orange button labeled \"**New String**,\" allowing the user to add additional variables.",
      "position": 3,
      "context": "can create up to five strings for each rule."
    },
    {
      "url": "https://helpimg.s3.amazonaws.com/PhishER/Rules/RuleDetails/EN/CreateConditions.png",
      "alt": "A technical manual description of the image:\n\nThe image displays a user interface segment titled \"**Create Conditions**\" (H2 level).\n\n**Contextual Text:**\nBelow the title, descriptive text is provided: \"Create conditions by selecting how your defined strings should relate to each other. Conditions are used to express what you want your rule to detect.\"\n\n**UI Elements (Radio Buttons):**\nA group of three radio buttons allows the user to select the logical relationship between defined strings for a detection rule.\n\n1.  **Match any of the defined strings** (Selected state, indicated by an orange ring and dot. The word 'any' is bolded.)\n2.  **Match all of the defined strings** (Unselected state. The word 'all' is bolded.)\n3.  **Custom conditions** (Unselected state.)",
      "position": 4,
      "context": "For more information about these options, see the screenshot and list below:"
    },
    {
      "url": "https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createconditions_customconditions.png",
      "alt": "This technical description details the interface for setting rule logic within the **Create Conditions** module.\n\n**Context and Introduction:**\nThe section is titled **Create Conditions**. It includes descriptive text: \"Create conditions by selecting how your defined strings should relate to each other. Conditions are used to express what you want your rule to detect.\"\n\n**Condition Type Selection (Radio Group):**\nThe user selects the logical relationship between predefined strings using a radio button group. The three available options are:\n1. Match **any** of the defined strings (Unselected)\n2. Match **all** of the defined strings (Unselected)\n3. **Custom conditions** (Selected)\n\n**Custom Condition Builder:**\nSince \"Custom conditions\" is selected, the interface for building detailed logical rules is displayed, starting with the label **Condition 1** (rendered in orange text).\n\n**Condition 1 Rule Editor:**\nThe active condition is enclosed within parentheses `( )`, representing a logical grouping. Within this structure are the following elements:\n*   **Dropdown Selector:** A standard dropdown menu labeled \"Choose string,\" allowing the selection of a defined string variable.\n*   **Add Button:** An orange button labeled \"Add,\" which includes a downward chevron, indicating a sub-menu for adding additional elements (e.g., logical operators like AND, OR, or NOT).\n*   **Remove Rule Control:** A small 'x' icon located at the far right of the condition group allows for the removal/deletion of the entire condition block.\n\n**Group Control:**\nBelow the active condition, a prominent orange button labeled **New Condition Group** is present. This button includes a downward chevron, indicating options for adding further, separately evaluated condition groups.",
      "position": 5,
      "context": "e page, select Custom conditions."
    },
    {
      "url": "https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createconditions_customconditions_choosestring.png",
      "alt": "The image displays a user interface segment for defining rule logic, titled \"Create Conditions.\"\n\n**Context:** The accompanying text clarifies that the purpose is to select how defined strings should relate to each other to create detection rules.\n\n**UI Elements and State:**\n\n1.  **Rule Type Selection (Radio Buttons):** Three options define the complexity of the condition matching:\n    *   Match **any** of the defined strings (Unselected)\n    *   Match **all** of the defined strings (Unselected)\n    *   **Custom conditions** (Selected)\n\n2.  **Custom Condition Builder (Active):** The selection of \"Custom conditions\" reveals an active condition group section labeled \"Condition 1.\"\n    *   **Input Field:** A structured input is presented within parentheses `()`. It currently contains a dropdown menu labeled \"**Choose string**\" and a adjacent split button labeled \"**Add**.\" A close/remove icon (`x`) is present at the right edge of the input box.\n\n3.  **Action Button:** At the bottom, a prominent orange split button allows for the creation of new logical sections: \"**New Condition Group**.\"",
      "position": 6,
      "context": "elect one of the strings you created."
    },
    {
      "url": "https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createconditions_addsecondstring.png",
      "alt": "This image displays a UI element for configuring conditional logic, labeled **\"Condition 1\"** (in orange text).\n\nThe core component is a rounded container representing a single condition row, structured by parentheses `(...)`.\n\n**Key UI elements are:**\n\n1.  **Variable/Field Selector:** A dropdown menu enclosed within the parentheses, currently displaying the placeholder variable **`\\$string_1`**.\n2.  **Action Button:** An orange button labeled **`Add \u02c5`** (highlighted by an intrusive orange arrow), indicating a primary action button with a dropdown menu for inserting new elements (e.g., operators, values, or nested conditions).\n3.  **Condition Removal Icon:** A small gray **`\u00d7`** icon located in the upper right corner of the container, used to delete the entire condition row.",
      "position": 7,
      "context": "ion, click the\u00a0Add drop-down menu."
    },
    {
      "url": "https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createconditions_choosesecondstring.png",
      "alt": "The image displays a user interface segment titled **\"Create Conditions\"** for defining rule logic based on input strings.\n\n**Context and Selection:**\n*   Instructional text explains that conditions define how defined strings should relate to each other for rule detection.\n*   Three mutually exclusive radio button options are provided for selecting the overall logic type:\n    *   Match **any** of the defined strings (Unselected)\n    *   Match **all** of the defined strings (Unselected)\n    *   **Custom conditions** (Selected)\n\n**Custom Condition Builder:**\n*   Since \"Custom conditions\" is selected, a condition builder area, labeled **\"Condition 1\"** (in orange), is displayed.\n*   The primary component is a logic row enclosed in parentheses. This row consists of three linked dropdown fields and an action button:\n    1.  A dropdown displaying the variable **`$string_1`**.\n    2.  A dropdown displaying the Boolean operator **`and`**.\n    3.  A dropdown placeholder displaying **`Choose string`**.\n*   An orange arrow visually indicates the **`Choose string`** dropdown as the current point of focus/interaction.\n*   An **`Add`** button (orange, with a dropdown chevron) is positioned next to the final dropdown, used to expand the current condition.\n*   A small 'x' icon is available at the far right to remove the entire condition row.\n\n**Action Button:**\n*   A large, primary button labeled **\"New Condition Group\"** (with a dropdown chevron) is positioned at the bottom, suggesting functionality for creating nested or parallel logical structures.",
      "position": 8,
      "context": "From this drop-down menu, select a string."
    },
    {
      "url": "https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/createconditions_newconditiongroup_button.png",
      "alt": "This image displays a segment of a UI dedicated to defining logical conditions or rules.\n\n**Key UI Elements and Text:**\n\n1.  **Section Header:** The orange text label at the top reads **Condition 1**, identifying the current rule set.\n2.  **Condition Builder:** A white, rounded input field defines a complex expression enclosed in parentheses.\n    *   **Expression Structure:** The current expression displays three concatenated dropdown elements: `($string_1 [Dropdown] and [Dropdown] $string_2 [Dropdown])`.\n    *   **Action Button (In-line):** A smaller orange button labeled **Add** includes a dropdown caret, allowing the user to add new variables or operators within the expression.\n    *   **Removal Control:** A gray 'x' icon is positioned at the far right of the input field, functioning as a delete control for the entire condition line.\n3.  **Primary Action Button:** A large, prominent orange button below the condition field is labeled **New Condition Group**. This button also features a dropdown caret, suggesting options for adding single conditions versus a logical group.\n\n*(Note: A large orange arrow annotation is present, visually directing attention to the \"New Condition Group\" button.)*",
      "position": 9,
      "context": "w Condition Group drop-down menu."
    },
    {
      "url": "https://helpimg.s3.amazonaws.com/PhishER/Documentation/RulesandActions/example_customconditions.png",
      "alt": "This interface displays the **Yara Rule Editor**, with the **Basic Editor** tab active. The editor is structured into two primary vertical panels: Create Strings and Create Conditions.\n\n**Left Panel: Create Strings**\nThis panel allows defining variables for rule content detection. Three strings are currently defined in input fields, each paired with an editable variable name and a removal icon:\n1.  `$string_1` is set to `.pdf`.\n2.  `$string_2` is set to `.htm`.\n3.  `$string_3` is set to `.exe`.\nAn orange button, **New String**, is available for adding definitions.\n\n**Right Panel: Create Conditions**\nThis panel defines the logical criteria for rule activation. Under condition types, **Custom conditions** is selected, overriding the \"Match any\" and \"Match all\" options.\nThe custom logic is displayed using two editable condition groups separated by the logical operator \"or\":\n1.  **Condition 1:** Consists of a parenthetical expression: `($string_1 [and] $string_2)`. String identifiers and the logical operator (`and`) are adjustable via dropdown menus. An orange **Add** button allows appending further elements.\n2.  **Condition 2:** Consists of a simpler parenthetical expression: `($string_3)`.\nA button labeled **New Condition Group** is provided to add additional logical blocks.\n\n**Footer Actions**\nThe interface concludes with two action buttons: an orange primary button, **Save Rule**, and a secondary button, **Apply Rule to Inbox**.",
      "position": 10,
      "context": "ple of custom conditions, see the screenshot and details below:"
    }
  ],
  "metadata": {
    "category": "",
    "section": "",
    "topics": [
      "and",
      "basic",
      "conditions",
      "editor",
      "strings",
      "the",
      "yara"
    ],
    "image_count": 10
  }
}</pre>
</body>
</html>