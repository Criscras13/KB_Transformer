{
  "article": {
    "id": 39716037815059,
    "url": "https://Criscras13.github.io/API_testing/api/v2/help_center/en-us/articles/39716037815059.json",
    "html_url": "https://Criscras13.github.io/API_testing/api/v2/help_center/en-us/articles/39716037815059.html",
    "author_id": 31899104510995,
    "comments_disabled": true,
    "draft": false,
    "promoted": false,
    "position": 0,
    "vote_sum": 1,
    "vote_count": 1,
    "section_id": 39403135069587,
    "created_at": "2025-03-25T16:31:44Z",
    "updated_at": "2025-08-08T10:00:19Z",
    "name": "Upgrading the Microsoft Outlook Add-In",
    "title": "Upgrading the Microsoft Outlook Add-In",
    "source_locale": "en-us",
    "locale": "en-us",
    "outdated": false,
    "outdated_locales": [],
    "edited_at": "2025-08-05T19:04:58Z",
    "user_segment_id": null,
    "permission_group_id": 195648,
    "content_tag_ids": [],
    "label_names": [
      "answerbot_protect"
    ],
    "body": "\n<p>This article provides guidance on upgrading the Microsoft Outlook add-In to the latest version.</p>\n<h2 id='h_01JR8X0681Y8AQXDYGSQ0EPQHR'>Manual Desktop Installation</h2>\n<ul>\n<li>The installation process is a simple click-through installer delivered in an .exe package.</li>\n<li>To run the installer, you must have admin privileges on the target machine. Local admin rights are sufficient.</li>\n</ul>\n<h2 id='h_01JR8X0681K7MRM7RW0RDPMRDC'>Silent Install</h2>\n<p>An MSI package that can be deployed silently via a command line or by using deployment tools such as SCCM.</p>\n<h3 id='h_01JR8X0681PATA27CZSJ19NFQB'>Command Line (msiexec)</h3>\n<p>The default command for installing the MSI via a command line is:</p>\n<ul>\n<li style='font-style: italic;'>msiexec /i \"EgressEmailProtection.msi\"</li>\n</ul>\n<p>The default command for uninstalling is:</p>\n<ul>\n<li style='font-style: italic;'>msiexec /x \"EgressEmailProtection.msi\"</li>\n</ul>\n<p>You can add other parameters, such as <span style='font-style: italic;'>/quiet</span>, as required.</p>\n<h3 id='h_01JR8X068159T0J4NMZ4KVEY7Q'>Command Line Switches</h3>\n<p>The MSI has several switches that can be set with the \"msiexec\" command to enable or disable certain features.</p>\n<table>\n<thead>\n<tr>\n<th scope='col'>Flag</th>\n<th scope='col'>Function</th>\n<th scope='col'>Values</th>\n<th scope='col'>Default Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>BYPASSOUTLOOKCHECK</td>\n<td>Bypass checking whether MS Outlook is open for fresh installs only and not upgrades. If upgrading from 21.06, this flag will work. Note: This switch does not apply to removing older versions, and Outlook must be closed in that scenario.</td>\n<td>Set these properties to something other than white space, such as \"1\", in order to bypass checks</td>\n<td>&lt;&lt;white-space&gt;&gt;</td>\n</tr>\n<tr>\n<td>INSTALLADDINKEYS</td>\n<td>Installs add-in keys (above) for all users on the machine Note: Users should use this key with the value \u201cNone\u201d when installing Citrix.</td>\n<td>\n<p>\"AllUsers\"</p>\n<p>\"CurrentUser\"</p>\n<p>\"None\"</p>\n</td>\n<td>\"AllUsers\"</td>\n</tr>\n</tbody>\n</table>\n<h3 id='h_01JR8X0681N9MAPDXQ3C218FNF'>Msiexec Install Command</h3>\n<p>Installing the Microsoft Outlook add-in requires the below install command:</p>\n<ul>\n<li style='font-style: italic;'>msiexec /i \"EgressEmailProtection.msi\" /quiet</li>\n</ul>\n<h3 id='h_01JR8X0681T733SYVPB87CFYX7'>Deployment Tools</h3>\n<p>Deployment tools such as Microsoft SCCM or Tivoli can be used to deploy the Outlook client to a large group of users in a controlled way.</p>\n<h2 id='h_01JR8X0681Q7PXKXJJH9K0G7VX'>Group Policy Deployment</h2>\n<p>To deploy the MSI package via group policy, add or update the package within the <strong>Computer Configuration</strong> section within the group policy by following the steps below:</p>\n<p><strong>Note:</strong> It is very important that the path to the MSI file is not local or run through a network drive. Instead, it should be through a network share, accessible from everywhere in your network and everyone should have at least Read permissions.</p>\n<ol>\n<li>Load the <strong>Group Policy Management</strong> console.</li>\n<li>\n<p>Right-click <strong>Group Policy Objects</strong> and select <strong>New</strong>.</p>\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/egress/0EM4J00000401Tt.jpg'> <img src='https://helpimg.s3.amazonaws.com/egress/0EM4J00000401Tt.jpg' alt=''> </a></p>\n</li>\n<li>Open the group policy object editor.</li>\n<li>Expand <strong>Computer Configuration</strong> <strong>Software Settings</strong>.</li>\n<li>\n<p>Right-click <strong>Software Settings</strong> and select <strong>Software Installation</strong> <strong>New</strong> <strong>Package\u2026</strong></p>\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/egress/0EM4J00000401U8.jpg'> <img src='https://helpimg.s3.amazonaws.com/egress/0EM4J00000401U8.jpg' alt=''> </a></p>\n</li>\n<li>Point to the EgressEmailProtection.msi file.</li>\n<li>Under <strong>Deployment Method</strong>, select <strong>Advanced</strong>. If you choose another option, you won't be able to apply an MST if required.</li>\n<li>Add a name for the package for easy identification.</li>\n</ol>\n<p>Once the group policy object is created, you will need to apply it to the relevant AD groups so that it is installed on user machines.</p>\n<h3 id='h_01JR8X0681QFNXF7RB9YFYQHXM'>ADMX Template</h3>\n<p>The preferred method for deploying the Microsoft Outlook client registry keys is by utilizing ADMX templates within a Group Policy. These template files contain various user-level registry settings that control the behavior of the Microsoft Outlook desktop client.</p>\n<p>Ensure that the ADMX template files have been placed in the relevant location. Typically, this is:</p>\n<ul>\n<li>ADMX: <span style='font-style: italic;'>C:\\Windows\\PolicyDefinitions</span>\n</li>\n<li>ADML:<span style='font-style: italic;'> C:\\Windows\\PolicyDefinitions\\en-us</span>\n</li>\n</ul>\n<p>The Microsoft Outlook client is highly configurable and different configurations not listed above can be controlled by command line switches and/or registry settings. As well as user settings, the client ADMX templates can apply machine-based policies such as the Gateway settings or SSO configuration.</p>\n<h2 id='h_01JR8X0681QQBNDZYXZVXWJNHS'>VDI Installation or Deploying in Hidden Mode</h2>\n<p>This section will cover the work involved in environments such as:</p>\n<ul>\n<li>Microsoft RDS</li>\n<li>Citrix</li>\n<li>General hot-desk or terminal server environments</li>\n</ul>\n<p>If you need to deploy to specific users in any of the above environments, you will need to deploy the add-in in a hidden state by default and then enable it using user-level registry keys. This action is common for organizations that haven\u2019t purchased a site-wide license where users do not have their own dedicated physical machines.</p>\n<h2 id='h_01JR8X0681H85YXZ9GK7NP2ZBQ'>Authentication Prerequisites</h2>\n<p>A token is stored within the local data. This token is refreshed daily to keep the user signed in. In doing so, the following folder paths must be persistent. The folder will depend on the environment you are configured to:</p>\n<ul>\n<li>AppData\\Local\\egress\\6\\switch.egress.com</li>\n<li>AppData\\Local\\egress\\6\\us1.esi.egress.com</li>\n<li>AppData\\Local\\egress\\6\\eu1.esi.egress.com</li>\n<li>For on-premise or separate hosted ESIs, replace the respective end folder with the hostname</li>\n</ul>\n<p>If users roam between multiple servers, an additional registry key must be applied to ensure they remain logged in when switching between them. This requirement is due to the login token is device-specific. If a user switches from Server A and then to Server B, they will be required to log in again.</p>\n<p>To prevent this issue, the following registry key must be applied.</p>\n<p>Location:</p>\n<ul>\n<li style='font-style: italic;'>HKEY_LOCAL_MACHINE \\Software \\Egress\\Switch</li>\n<li style='font-style: italic;'>HKEY_LOCAL_MACHINE \\Software\\Wow6432node\\Egress\\Switch</li>\n</ul>\n<p>Registry Key:</p>\n<ul>\n<li>REG_SZ (String) with the name: DeviceID</li>\n<li>Value: profile</li>\n</ul>\n<p>Not all users may require the Microsoft Outlook add-in. For some users, the add-in must be installed in the disabled format and then targeted for specific users.</p>\n<h3 id='h_01JR8X06815Q384PM0FMY1VSN5'>Msiexec Install</h3>\n<p>Install can be performed by via GPO, SCCM, or other deployment tools.</p>\n<h4 id='h_01JR8X0681Z31VHCKMMB8RBM8Q'>Msiexec Installed in Hidden Mode</h4>\n<p>Install with the following Command:</p>\n<ul>\n<li>msiexec /i \"EgressEmailProtection.msi\" /quiet INSTALLADDINKEYS='None'</li>\n</ul>\n<h4 id='h_01JR8X0681P4R8W64QT3PSWWZP'>Show Add-In for Targeted Users</h4>\n<p>To show the plugin for specific users, the following registry keys are required:</p>\n<ul>\n<li>[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\Outlook\\Addins\\EgressEmailProtection]</li>\n<li>\"LoadBehavior\"=dword:00000003</li>\n<li>\"Manifest\"=' file:///C:\\Program Files (x86)\\Egress Email Protection\\EmailProtection.vsto|vstolocal'</li>\n</ul>\n<p>If GPO is required for registry key push out, please follow the guidance below for GPO only install from step two onwards.</p>\n<h2 id='h_01JR8X0681Z42P524BMTQJF21Y'>GPO Only Install</h2>\n<p>To install for GPO, follow the steps below:</p>\n<ol>\n<li>Create a new GPO with the new Microsoft Outlook client and add the MST to the modification tab. This action will install the add-in in the disabled format.</li>\n<li>\n<p>Ensure the ADMX templates have been added. Once the templates are in place, right-click the group policy and select Edit. Follow this path: <strong>User Configuration</strong> <strong>Administrative Templates</strong> <strong>Egress Settings</strong>.</p>\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/egress/0EM4J00000401b9.jpg'> <img src='https://helpimg.s3.amazonaws.com/egress/0EM4J00000401b9.jpg' alt=''> </a></p>\n</li>\n<li>\n<p>A list of policy options will be displayed in this folder.</p>\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/egress/0EM4J00000401bJ.jpg'> <img src='https://helpimg.s3.amazonaws.com/egress/0EM4J00000401bJ.jpg' alt=''> </a></p>\n</li>\n<li>In most cases, to enable the client for certain users, it is recommended you configure each of the following options and set their actions as below:\n<ul>\n<li>\n<p>Email Resiliency - To force Microsoft Outlook to always load the Microsoft Outlook add-in and prevent users from disabling it, the value should be set to <strong>1</strong>.</p>\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/egress/0EM4J00000401cW.jpg'> <img src='https://helpimg.s3.amazonaws.com/egress/0EM4J00000401cW.jpg' alt=''> </a></p>\n</li>\n<li>\n<p>Load Behavior Add-in - This setting will load and enable the Microsoft Outlook add-in. It should be set to <strong>3</strong>.</p>\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/egress/0EM4J00000401dA.jpg'> <img src='https://helpimg.s3.amazonaws.com/egress/0EM4J00000401dA.jpg' alt=''> </a></p>\n</li>\n<li>Manifest Outlook Add-in - Loads the Microsoft Outlook add-in manifest file. This setting should be set to:\n<ul>\n<li>file///C:\\Program Files (x86)\\Egress Email Protection\\EmailProtection.vsto|vstolocal</li>\n</ul>\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/egress/0EM4J00000401dZ.jpg'> <img src='https://helpimg.s3.amazonaws.com/egress/0EM4J00000401dZ.jpg' alt=''> </a></p>\n</li>\n</ul>\n</li>\n</ol>\n<p>If there is a mixture of 32-bit and 64-bit machines, use WMI filtering or Item-Level Targeting to apply the correct path based on the OS bitness.</p>\n<p>Once the appropriate policy definitions have been defined, ensure that your GPO is saved, linked to the right domain, and applied to the relevant AD security group.</p>\n<h2 id='h_01JR8X06811KKGCBBZGT07J9Q5'>FAQs</h2>\n<p>The most common questions or issues about upgrading the Microsoft Outlook add-in are addressed below.</p>\n<ol>\n<li>The naming convention has been updated from Egress.Switch to EgressEmailProtection for where the LoadBehavior &amp; Manifest keys reside:\n<ol type='alpha'>\n<li style='font-style: italic;'>HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Office\\Outlook\\Addins\\EgressEmailProtection</li>\n<li style='font-style: italic;'>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Office\\Outlook\\Addins\\EgressEmailProtection</li>\n</ol>\n</li>\n<li>To ensure the plugin stays enabled, the following keys should be pushed out by the admin:\n<ul>\n<li>EgressEmailProtection\n<ul>\n<li>Value: 1</li>\n<li>Type: String</li>\n<li>Location: [HKEY_CURRENT_USER\\SOFTWARE\\Policies\\Microsoft\\office\\16.0\\outlook\\Resiliency\\AddinList]</li>\n</ul>\n</li>\n<li>LoadBehavior\n<ul>\n<li>Value: 3</li>\n<li>Type: DWORD</li>\n<li>Location: [HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Office\\Outlook\\Addins\\EgressEmailProtection]</li>\n</ul>\n</li>\n<li>EgressEmailProtection\n<ul>\n<li>Value: 1</li>\n<li>Type: DWORD</li>\n<li>Location: [HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Office\\16.0\\Outlook\\Resiliency\\DoNotDisableAddinList]</li>\n</ul>\n</li>\n<li>EgressEmailProtection\\dtype\n<ul>\n<li>Value: 0</li>\n<li>Type: DWORD</li>\n<li>Location: [HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Office\\16.0\\Outlook\\Resiliency\\NotificationReminderAddinData]</li>\n</ul>\n</li>\n<li>EgressEmailProtection\n<ul>\n<li>Value: 967a844d</li>\n<li>Type: DWORD</li>\n<li>Location: [HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Office\\16.0\\Outlook\\Resiliency\\NotificationReminderAddinData]</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>",
    "user_segment_ids": []
  }
}