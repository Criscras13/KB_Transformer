{
  "article": {
    "id": 360054494394,
    "url": "https://Criscras13.github.io/API_testing/api/v2/help_center/en-us/articles/360054494394.json",
    "html_url": "https://Criscras13.github.io/API_testing/api/v2/help_center/en-us/articles/360054494394.html",
    "author_id": 403968826754,
    "comments_disabled": true,
    "draft": false,
    "promoted": false,
    "position": 2,
    "vote_sum": 16,
    "vote_count": 28,
    "section_id": 26245163158547,
    "created_at": "2020-09-28T15:31:13Z",
    "updated_at": "2025-10-29T17:05:19Z",
    "name": "Direct Message Injection (DMI) Configuration Guide",
    "title": "Direct Message Injection (DMI) Configuration Guide",
    "source_locale": "en-us",
    "locale": "en-us",
    "outdated": false,
    "outdated_locales": [],
    "edited_at": "2025-10-24T18:59:42Z",
    "user_segment_id": null,
    "permission_group_id": 195648,
    "content_tag_ids": [],
    "label_names": [
      "whitelisting",
      "white listing",
      "direct message injection",
      "dmi",
      "DMI FAQ",
      "message injection",
      "localized",
      "answerbot",
      "answerbot_kmsat"
    ],
    "body": "<p>The Direct Message Injection (DMI) feature eliminates the need to whitelist simulated phishing emails. DMI bypasses email filtering rules and places emails into your users\u2019 inboxes. This feature works by creating a secure link between your KSAT console and your mail server. DMI can be used to whitelist our phishing test emails, but training emails will still require additional whitelisting if you use this method. For more information, see our <a href='https://Criscras13.github.io/API_testing/api/v2/help_center/en-us/articles/203645138.html'>Whitelisting Guide</a>.</p>\n<div class='callout-remember'>\n<div>\n<strong>Important:</strong>Some whitelisting configurations may not be available in environments outside of the US.</div>\n</div>\n<h2 id='iv_01H8FH3R9RQ0A14Y8G4H79Z1XS'>Setting Up DMI in Microsoft 365</h2>\n<div class='callout-remember'>\n<div>\n<strong>Note:</strong>In February 2025, Microsoft retired the Application Impersonation admin role used by our Microsoft DMI connection. This change will affect your DMI connections and cause them to break. If you currently use DMI as your whitelisting method, we recommend you update your whitelisting to use <a href='https://Criscras13.github.io/API_testing/api/v2/help_center/en-us/articles/4404511190803.html'>advanced delivery policies</a>. After advanced delivery policy whitelisting is set up, you must disable your DMI connection.</div>\n</div>\n<h2 id='h_01J420XHXY9RXJGG56RX0666G8'>Setting Up DMI in Google</h2>\n<p>If you are using Google Workspace, this secure connection is created by authorizing the DMI application in Google Workspace. Once authorized, DMI uses the Google Workspace APIs to place simulated phishing emails into your users\u2019 inboxes.</p>\n<div class='callout-note'>\n<div>\n<strong>Note:</strong>You cannot use your Google Workspace DMI connection to send messages to alias email addresses.</div>\n</div>\n<h3 id='h_01J420YHX9R1QTYRFWSFX74H57'>Required Admin Roles for Google</h3>\n<p>If you are setting up a Google Workspace DMI, you will need an account with a super admin role. For more information, see Google\u2019s <a href='https://support.google.com/a/answer/162106' target='_blank' rel='noopener noreferrer'>Control API access with domain-wide delegation</a> article.</p>\n<h3 id='iv_01H8FH3R9RRS9GFH4HJZWREH19'>Connect DMI to Google</h3>\n<p>To connect DMI to Google Workspace, you will need to add a client ID and scopes to your Google Workspace Admin console. To add the client ID and scopes, follow the steps below:</p>\n<ol>\n<li>Navigate to admin.google.com.</li>\n<li>In the Google Workspace Admin console, select the <strong>Security</strong> section.\n<div class='callout-note'>\n<div>\n<strong>Note:</strong>If you do not see <strong>Security</strong>, click <strong>More controls</strong> at the bottom of the page.</div>\n</div>\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/KMSAT/Account_Settings/Direct-Message-Injection/EN/GoogleSecurityButton.png'><img src='https://helpimg.s3.amazonaws.com/KMSAT/Account_Settings/Direct-Message-Injection/EN/GoogleSecurityButton.png' alt='Google Workspace Admin Security section'></a></p>\n</li>\n<li>Click <strong>Overview</strong>.</li>\n<li>Select the <strong>API controls</strong> section.</li>\n<li>In the <strong>Domain wide delegation</strong> section, click the <strong>Manage Domain Wide Delegation </strong>button.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/KMSAT/Account_Settings/Direct-Message-Injection/EN/GoogleManageDomainWideDelegationButton.png'><img src='https://helpimg.s3.amazonaws.com/KMSAT/Account_Settings/Direct-Message-Injection/EN/GoogleManageDomainWideDelegationButton.png' alt='Manage Domain wide delegation button'></a></p>\n</li>\n<li>Click the <strong>Add new</strong> button.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/KMSAT/Account_Settings/Direct-Message-Injection/EN/GoogleAddNewButton.png'><img src='https://helpimg.s3.amazonaws.com/KMSAT/Account_Settings/Direct-Message-Injection/EN/GoogleAddNewButton.png' alt='Add new button'></a></p>\n</li>\n<li>In the <strong>Client ID</strong> field, enter \"117081416267426756182\".\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/KMSAT/Account_Settings/Direct-Message-Injection/EN/GoogleClientID.png'><img src='https://helpimg.s3.amazonaws.com/KMSAT/Account_Settings/Direct-Message-Injection/EN/GoogleClientID.png' alt='Client ID field'></a></p>\n</li>\n<li>In the <strong>OAuth Scopes</strong> field, enter \"https://www.googleapis.com/auth/gmail.insert\".</li>\n<li>Click the <strong>Authorize</strong> button.</li>\n</ol>\n<h3 id='iv_01H8FH3R9S4CAQQWAPK7HAAQHV'>Enable DMI for Google</h3>\n<p>After you have connected <a href='#iv_01H8FH3R9RRS9GFH4HJZWREH19'>DMI to Google</a>, you will need to enable DMI in your KSAT console. You will also need to enable the <strong>Overwrite Fixed Return-path Address with Sender Address</strong> setting. To enable DMI for Google Workspace, follow the steps below:</p>\n<ol>\n<li>Log in to your KSAT console.</li>\n<li>Click your email address in the top-right corner of the page and select <strong>Account Settings</strong>.</li>\n<li>Navigate to the <strong>Direct Message Injection (DMI)</strong> section.</li>\n<li>Click the <strong>Add DMI Connection</strong> drop-down menu and select <strong>Google Workspace</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/KMSAT/Account_Settings/Direct-Message-Injection/EN/DMIConnection-DropDownMenu.png'><img src='https://helpimg.s3.amazonaws.com/KMSAT/Account_Settings/Direct-Message-Injection/EN/DMIConnection-DropDownMenu.png' alt='Add DMI Connection drop-down menu'></a></p>\n</li>\n<li>Fill out the fields in the configuration pop-up window. For more information, see the screenshot and list below:\n<ol type='a'>\n<li>\n<strong>Connection Name</strong>: Enter a name for the DMI connection.</li>\n<li>\n<strong>Enable this connection for the selected domain</strong>: Select one or more domains by entering the domain name or selecting domains from the drop-down menu.\n<div class='callout-note'>\n<div>\n<strong>Note:</strong>DMI will only be enabled for users whose primary email addresses match the selected domains.</div>\n</div>\n</li>\n<li>\n<strong>If the DMI connection fails, send a notification to</strong>: Enter the email addresses of anyone who should be notified if the DMI connection fails.\n<div class='callout-note'>\n<div>\n<strong>Note:</strong>Email addresses entered in this field do not need to match the domains listed in the <strong>Enable this connection for the selected domain </strong>field.</div>\n</div>\n</li>\n<li>\n<strong>Enter an email address from your Google Workspace domain: </strong>Enter the email address where you would like to receive the test message.</li>\n</ol>\n</li>\n<li>Repeat steps four and five for each domain you want to configure.</li>\n<li>Click the <strong>Save Connection Settings</strong> button.</li>\n</ol>\n<p>You will also need to overwrite the return-path header for your phishing emails. The Overwrite Fixed Return-path Address with Sender Address setting is located in your account settings. For further information on enabling this setting, see our <a href='https://Criscras13.github.io/API_testing/api/v2/help_center/en-us/articles/115004965687.html'>How to Change the Return-Path Header in Your Account Settings</a> article.</p>\n<div class='callout-remember'>\n<div>\n<strong>Important:</strong>After configuring DMI for Google Workspace, post-delivery inbox filtering may still interfere with recorded email interactions, email delivery, or attachment functionality.</div>\n</div>\n<h3 id='iv_01H8FH3R9SJYG5XMEPXTRK0GWW'>How to Fix a Connection Error in Google Workspace</h3>\n<p>If you receive an error message after clicking <strong>Authorize</strong> when connecting DMI to Google Workspace, your client ID and scopes may be incorrect.</p>\n<p>To check your client ID and scopes, follow the steps below:</p>\n<ol>\n<li>Locate the new domain-wide delegation permissions that you created.</li>\n<li>Click <strong>View Details</strong>.</li>\n<li>Ensure that every scope is listed, there are no duplicate scopes, and that the client ID is correct.</li>\n<li>\n<p>If a scope is missing or contains an error, click <strong>Edit</strong>, enter the missing scope, and click <strong>Authorize</strong> to apply the changes.</p>\n<div class='callout-note'>\n<div>\n<strong>Note:</strong>The client ID cannot be changed.</div>\n</div>\n</li>\n</ol>\n<h2 id='iv_01H8FH3R9ST6CFZ6P4M07AA52P'>How to Add Banners, Prefixes, and Signatures to Phishing Emails</h2>\n<p>When DMI is enabled, our phishing emails are able to bypass all mail flow rules, which may include banners, prefixes, and signatures that appear on inbound emails.</p>\n<p>Follow the steps below to use our placeholders to add banners, prefixes, and signatures back to our phishing emails:</p>\n<ol>\n<li>Log in to your KSAT console.</li>\n<li>Click your email in the top-right corner of the page and select <strong>Account Settings</strong>.</li>\n<li>Navigate to the <strong>Placeholders</strong> section.</li>\n<li>Click <strong>+ Placeholders</strong>.</li>\n<li>Select the placeholder that you want to add back to the phishing email from the drop-down menu.</li>\n<li>Enter the placeholder's information into the field provided. You can enter any text into the field, including source code from an email banner, prefix, or signature that already exists.</li>\n<li>For the <strong>Email Banner </strong>and <strong>Subject Prefix</strong> placeholder, select which phishing emails you want the placeholder to appear on from the drop-down menu.</li>\n<li>Click <strong>Save Placeholders</strong>.</li>\n</ol>\n<h2 id='iv_01H8FH3R9S9ZWCHVXJHFTKZZC7'>Disconnect a DMI Connection</h2>\n<p>When disabling DMI, we recommend removing the connection between your KSAT console and your mail client account.</p>\n<p>To disconnect DMI, follow the steps below:</p>\n<ol>\n<li>Log in to your KSAT console.</li>\n<li>Click your email in the top-right corner of the page and select <strong>Account Settings</strong>.</li>\n<li>Navigate to the <strong>Direct Message Injection (DMI)</strong> section under <strong>Phishing</strong>.</li>\n<li>Locate the DMI connection you would like to delete, and click the <strong>Show Settings</strong> button.\n<div class='callout-note'>\n<div>\n<strong>Note:</strong>The name of this button will change based on the name of your connection. For example, if the name of your connection is \"DMI 1,\" this button will display as \"Show DMI 1 Settings.\"</div>\n</div>\n</li>\n<li>Click the <strong>Remove DMI Connection</strong> button.</li>\n<li>When the confirmation message opens, click the <strong>Confirm</strong> button.</li>\n</ol>\n<div class='callout-remember'>\n<div>\n<strong>Important:</strong>When your DMI connection is removed, active phishing campaigns will send emails using Standard Email Protocol (SMTP). If DMI was enabled when the campaign was created, emails will still show as <strong>DMI-delivered</strong> on the campaign's <strong>Overview</strong> subtab.</div>\n</div>\n<p>If you re-enable DMI in the future, you will need to grant KnowBe4 access again. To re-enable DMI, follow the steps in the sections above for your mail server.</p>\n<div class='callout-tip'>\n<div>\n<strong>Tip:</strong>To ensure that you have whitelisted correctly, see our <a href='https://Criscras13.github.io/API_testing/api/v2/help_center/en-us/articles/1500007900421.html'>Verify Your Whitelisting</a> article.</div>\n</div>",
    "user_segment_ids": []
  }
}