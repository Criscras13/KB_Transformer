{
  "article": {
    "id": 39716025668755,
    "url": "https://Criscras13.github.io/API_testing/api/v2/help_center/en-us/articles/39716025668755.json",
    "html_url": "https://Criscras13.github.io/API_testing/api/v2/help_center/en-us/articles/39716025668755.html",
    "author_id": 31899104510995,
    "comments_disabled": true,
    "draft": false,
    "promoted": false,
    "position": 0,
    "vote_sum": 0,
    "vote_count": 0,
    "section_id": 39403151377683,
    "created_at": "2025-03-25T16:31:55Z",
    "updated_at": "2025-08-08T09:57:18Z",
    "name": "Web Add-In - Using Microsoft's On-Send Feature",
    "title": "Web Add-In - Using Microsoft's On-Send Feature",
    "source_locale": "en-us",
    "locale": "en-us",
    "outdated": false,
    "outdated_locales": [],
    "edited_at": "2025-08-05T19:04:54Z",
    "user_segment_id": null,
    "permission_group_id": 195648,
    "content_tag_ids": [],
    "label_names": [
      "answerbot_protect"
    ],
    "body": "\n<p>When using the web add-in with Microsoft Outlook, it is crucial that users allow the add-in to complete its processing before sending an email. If a user navigates away from the email while it is still processing, they may encounter the error message below.\u00a0</p>\n<p><span><strong>Your email was not sent: One or more add-ins could not complete processing your email after you navigated away from it. Your email has been moved to the drafts folder. Resend your email from the Drafts folder and remain on it until the add-in completes processing.</strong></span></p>\n<div class='callout-note'>\n<div class='callout_content'>\n<strong>Note:</strong>This limitation applies to all web add-ins that interact with Microsoft Outlook, not just ours, as this is a constraint of the Microsoft Outlook add-in architecture. The exact wording may vary depending on the Microsoft Outlook version in use.\u00a0</div>\n</div>\n<p>The web add-in scans emails and attachments to provide accurate advice on Data Loss Prevention (DLP) categories and misdirected recipient advice. For this functionality to work correctly, the add-in must finish its processing before the email is sent.\u00a0</p>\n<h2 id='h_01JQBS9D400H9HKMT7N39HV5QC'>Microsoft's Suggested Solution: On-Send Microsoft Feature</h2>\n<p>To address this issue, Microsoft recommends enabling the On-Send feature for users with the web add-in. This feature ensures that when an email is sent, it is opened in a new window, allowing the add-in to complete its processing in the background. Users can continue to use Microsoft Outlook without interruption, and any necessary prompts will still appear.</p>\n<div class='callout-warning'>\n<div class='callout__content'>\n<strong>Warning:</strong>While the On-Send feature offers certain benefits, we advise customers to consider its implementation due to potential email transmission disruptions. Organizations should carefully evaluate whether the functionality benefits justify the associated risks.</div>\n</div>\n<p>To enable the On-Send feature, admins can modify the user mailbox policy. The following PowerShell command updates the default policy to apply this feature automatically to new users with the web add-in installed:\u00a0</p>\n<p><em>Set-OwaMailboxPolicy OwaMailboxPolicy-Default -OnSendAddinsEnabled:$true</em></p>\n<p>For admins trialing the web add-in with a specific group of users, the following commands can be used:</p>\n<div class='callout-note'>\n<div class='callout_content'>\n<strong>Note:</strong>Users who have the web add-in installed after the command is run will not get the policy applied.</div>\n</div>\n<p><em>New-OwaMailboxPolicy EgressOnSendPolicy <br>Set-OwaMailboxPolicy EgressOnSendPolicy -OnSendAddinsEnabled:$true <br>$targetUsers = Get-Group &lt;Groupname&gt;|select -ExpandProperty members <br>$targetUsers | Get-User -Filter {RecipientTypeDetails -eq 'UserMailbox'}|Set-CASMailbox -OwaMailboxPolicy EgressOnSendPolicy</em></p>\n<p>The video below displays how this change will look for your users:</p>\n<div style='padding: 56.25% 0 0 0; position: relative;'><iframe style='position: absolute; top: 0; left: 0; width: 100%; height: 100%;' title='EWA Drafts Fix' src='https://player.vimeo.com/video/1060137185?badge=0&amp;autopause=0&amp;player_id=0&amp;app_id=58479' frameborder='0' scrolling='auto' allow='autoplay; fullscreen; picture-in-picture; clipboard-write; encrypted-media'></iframe></div>\n<p>\n<script src='https://player.vimeo.com/api/player.js'></script>\n</p>",
    "user_segment_ids": []
  }
}