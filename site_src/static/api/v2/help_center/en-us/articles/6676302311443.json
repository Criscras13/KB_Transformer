{
  "article": {
    "id": 6676302311443,
    "url": "https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/6676302311443.json",
    "html_url": "https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/6676302311443.html",
    "author_id": 403968826754,
    "comments_disabled": true,
    "draft": false,
    "promoted": false,
    "position": 15,
    "vote_sum": 1,
    "vote_count": 3,
    "section_id": 45304403431955,
    "created_at": "2022-06-02T16:48:41Z",
    "updated_at": "2025-10-03T19:28:44Z",
    "name": "Microsoft 365 and Microsoft Defender for Cloud Apps Integration Guide for SecurityCoach",
    "title": "Microsoft 365 and Microsoft Defender for Cloud Apps Integration Guide for SecurityCoach",
    "source_locale": "en-us",
    "locale": "en-us",
    "outdated": false,
    "outdated_locales": [],
    "edited_at": "2025-09-05T16:51:15Z",
    "user_segment_id": null,
    "permission_group_id": 195648,
    "content_tag_ids": [],
    "label_names": [
      "answerbot",
      "securitycoach",
      "securitycoach integrations",
      "vendor integration",
      "Security Coach",
      "Integration Guide",
      "answerbot_securitycoach"
    ],
    "body": "<p>In this article, you will learn how to integrate Microsoft 365 and Microsoft Defender for Cloud Apps, formerly Microsoft Cloud Access Security (MCAS), with SecurityCoach. Once the integration is complete, data provided by Microsoft will be available under the <strong>SecurityCoach</strong> tab of your KSAT console. This data can be viewed in SecurityCoach reports and used to create detection rules for real-time coaching campaigns.</p>\n<div style='padding: 56.25% 0 0 0; position: relative;'><iframe style='position: absolute; top: 0; left: 0; width: 100%; height: 100%;' src='https://player.vimeo.com/video/812525744' frameborder='0' allow='autoplay; fullscreen; picture-in-picture; clipboard-write; encrypted-media'></iframe></div>\n<p>\n<script src='https://player.vimeo.com/api/player.js'></script>\n</p>\n<div style='padding: 56.25% 0 0 0; position: relative;'><iframe style='position: absolute; top: 0; left: 0; width: 100%; height: 100%;' src='https://player.vimeo.com/video/812527193' frameborder='0' allow='autoplay; fullscreen; picture-in-picture; clipboard-write; encrypted-media'></iframe></div>\n<p>\n<script src='https://player.vimeo.com/api/player.js'></script>\n</p>\n<p>For more information about SecurityCoach, see our <a href='https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/6654432814355.html'>SecurityCoach Product Manual</a>. To integrate other Microsoft products with SecurityCoach, see our <a href='https://support.knowbe4.com/hc/en-us/sections/10969917980435'>Setting Up Integrations</a> articles.</p>\n<div class='callout-tip'>\n<div>\n<strong>Tip:</strong>SecurityCoach also supports integrating Microsoft 365 and Microsoft Defender for Cloud Apps as Splunk vendors. If your organization uses Splunk for security information and event management, we recommend integrating through Splunk instead by following our <a href='https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/36888064642451.html'><span class='wysiwyg-underline' style='color: #1155cc;'>Splunk Integrations Guide for SecurityCoach</span></a>.</div>\n</div>\n<h2 id='h_01JZXF83P3S0SX31777M0NNBJZ'>Prerequisites</h2>\n<h3 id='h_01K0FCGW8282SP22615VNR6PEN'>Microsoft 365</h3>\n<p>One of the following Microsoft license bundles is required to ensure a successful Microsoft 365 integration:</p>\n<ul>\n<li>\n<strong>Microsoft 365 E5</strong> with the <strong>Microsoft 365 E5 Security</strong> and <strong>Microsoft 365 E5 Compliance</strong> add-ons</li>\n<li>\n<strong>Microsoft Enterprise Mobility</strong> with the <strong>Microsoft 365 E5 Security</strong> add-on</li>\n<li><strong>Microsoft Office 365 E5</strong></li>\n</ul>\n<p>For more information, see <a href='https://learn.microsoft.com/en-us/defender-xdr/prerequisites' target='_blank' rel='noopener'>Microsoft\u2019s Defender XDR licensing requirements</a>.</p>\n<h3 id='h_01K0FCGW822H1C6D1KE590DYXK'>Microsoft Defender for Cloud Apps</h3>\n<p>One of the following Microsoft license bundles is required to ensure a successful Microsoft Defender for Cloud Apps integration:</p>\n<ul>\n<li>\n<strong>Microsoft 365 E5</strong> with the <strong>Microsoft E5 Security</strong> add-on</li>\n<li><strong>Windows 11 Enterprise E5</strong></li>\n</ul>\n<p>For more information, see <a href='https://learn.microsoft.com/en-us/defender-xdr/prerequisites' target='_blank' rel='noopener'>Microsoft\u2019s Defender XDR licensing requirements</a>.</p>\n<div class='callout-note'>\n<div>\n<strong>Note:</strong>Microsoft Government Community Cloud (GCC) integrations are not supported at this time.</div>\n</div>\n<h2 id='h_01HER1JAAPJZCS9KE79K5STGJV'>Set Up the Integration in Your Microsoft Azure Portal</h2>\n<p>Before you can set up the SecurityCoach integration in your KSAT console, you will need to register the SecurityCoach application, add API permissions, and create a client secret in your Microsoft Azure portal.</p>\n<div class='callout-remember'>\n<div>\n<strong>Important:</strong>To integrate Microsoft 365 and Microsoft MCAS with the KSAT console, you will need a unique registered application, API permission, client secret, and tenant for each product.</div>\n</div>\n<p>To jump to the article subsection for each of these steps, click the links below:</p>\n<ul>\n<li><a href='#h_01HER1JAAPC4Y4SD3B0NQ51CKG'>Register the SecurityCoach Application</a></li>\n<li><a href='#h_01HER1JAAPT69BBSG020RRNH49'>Add API Permissions</a></li>\n<li><a href='#h_01GB31Y8QMDJ1QWR14YT9C8KTV'>Create a Client Secret</a></li>\n</ul>\n<h3 id='h_01K0FCGW82BZSAE40F7K2W10FT'>Register the SecurityCoach Application</h3>\n<p>First, you will need to register the SecurityCoach application in your Microsoft Azure portal. To register the application, follow the steps below:</p>\n<ol>\n<li>Log in to your Microsoft Azure portal and navigate to your <strong>Microsoft Entra ID</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_azureactivedirectory.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_azureactivedirectory.png' alt=' '></a></p>\n</li>\n<li>From the sidebar on the left side of the page, select <strong>App registrations</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_appregistrations.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_appregistrations.png' alt=' '></a></p>\n</li>\n<li>Click <strong>+ New registration</strong> and enter a name for your application, such as \u201cSecurityCoachAPIAccess\u201d.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_newregistration.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_newregistration.png' alt=' '></a></p>\n</li>\n<li>Click <strong>Register</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_365_mcas_register.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_365_mcas_register.png' alt=' '></a></p>\n</li>\n</ol>\n<h3 id='h_01HER1JAAPT69BBSG020RRNH49'>Add API Permissions</h3>\n<p>After you have registered the SecurityCoach application, you can add API permissions. To add API permissions, follow the steps below:</p>\n<ol>\n<li>Log in to your Microsoft Azure portal and navigate to your <strong>Microsoft Entra ID</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_azureactivedirectory.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_azureactivedirectory.png' alt=' '></a></p>\n</li>\n<li>From the sidebar on the left side of the page, select <strong>App registrations</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_appregistrations.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_appregistrations.png' alt=' '></a></p>\n</li>\n<li>Select the registered application you created for Microsoft 365 or MCAS in the <a href='#h_01HER1JAAPC4Y4SD3B0NQ51CKG'>Register the SecurityCoach Application</a> section of this guide. In the example below, the registered application is titled \u201cMS-Alert\u201d.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_application.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_application.png' alt=' '></a></p>\n</li>\n<li>From the sidebar on the left side of the page, select <strong>API permissions</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_apipermissions.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_apipermissions.png' alt=' '></a></p>\n</li>\n<li>Click <strong>+ Add a permission</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_addapermission.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_addapermission.png' alt=' '></a></p>\n</li>\n<li>Select <strong>Microsoft Graph</strong> from the <strong>Microsoft APIs</strong> subtab.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_microsoftgraph.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_microsoftgraph.png' alt=' '></a></p>\n</li>\n<li>Click <strong>Application permissions</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_applicationpermissions.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_applicationpermissions.png' alt=' '></a></p>\n</li>\n<li>Click the <strong>SecurityAlert</strong> drop-down menu and select the check box next to <strong>SecurityAlert.Read.All</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_addpermissions.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_addpermissions.png' alt=' '></a></p>\n</li>\n<li>Click <strong>Add permissions</strong>.</li>\n<li>Click <strong>Grant admin consent for [your active directory name]</strong>. Once permission is granted, the triangle symbol on the right side of the page will change to a green check mark.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_granted.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_granted.png' alt=' '></a></p>\n</li>\n</ol>\n<h3 id='h_01K0FCGW82CAWSQAYYZTVV7VTV'>Create a Client Secret</h3>\n<p>After you have registered the SecurityCoach application and added API permissions, you can create a client secret. To create a client secret, follow the steps below:</p>\n<ol>\n<li>Log in to your Microsoft Azure portal and navigate to your <strong>Microsoft Entra ID</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_azureactivedirectory.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_azureactivedirectory.png' alt=' '></a></p>\n</li>\n<li>From the sidebar on the left side of the page, select <strong>App registrations</strong> and click on the registered application you added permissions to in the <a href='#h_01HER1JAAPT69BBSG020RRNH49'>Add API Permissions</a> section of this article. When you click on the registered application, the application\u2019s overview page will display.</li>\n<li>From the sidebar on the left side of the page, select <strong>Certificates &amp; secrets</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_certificatesandsecrets.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_certificatesandsecrets.png' alt=' '></a></p>\n</li>\n<li>Click <strong>+ New client secret</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_newclientsecret.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_newclientsecret.png' alt=' '></a></p>\n</li>\n<li>Enter a description for the client secret and select an expiry window.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_descriptionadd.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_descriptionadd.png' alt=' '></a></p>\n</li>\n<li>Click <strong>Add</strong>. Once you click <strong>Add</strong>, the client secret <strong>Value</strong> and <strong>Expires</strong> date will display.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_value.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_value.png' alt=' '></a></p>\n</li>\n<li>Copy and save the client secret <strong>Value</strong> and the <strong>Expires</strong> date somewhere that you can easily access. You will need these credentials to complete the integration setup in the <a href='#h_01HER1JAAPNP93M36DMHBXAR54'>Set Up the Integration in Your KSAT Console</a> section below.</li>\n</ol>\n<h2 id='h_01HER1JAAPNP93M36DMHBXAR54'>Set Up the Integration in Your KSAT Console</h2>\n<p>Once you've set up the integration in your Microsoft Azure portal, you can set up the integration in your KSAT console.</p>\n<div class='callout-note'>\n<div>\n<strong>Note:</strong>To complete these steps, you will need to have both your Microsoft Azure portal and your KSAT console open in your browser.</div>\n</div>\n<p>To set up the integration in your KSAT console, follow the steps below:</p>\n<ol>\n<li>Log in to your KSAT console and navigate to <strong>SecurityCoach</strong> &gt; <strong>Setup</strong>.</li>\n<li>In the <strong>Available Integrations</strong> section, locate the card for the Microsoft application you want to set up.</li>\n<li>At the bottom of the card, click <strong>Configure</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_365_mcas_configure.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_365_mcas_configure.png' alt=' '></a></p>\n</li>\n<li>In a separate browser window, log in to your Microsoft Azure portal and navigate to your <strong>Microsoft Entra ID</strong>.</li>\n<li>From the <strong>Overview</strong> page, scroll down to the <strong>Tenant information</strong> section. Then, copy the <strong>Primary domain</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_primarydomain.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_primarydomain.png' alt=' '></a></p>\n</li>\n<li>Navigate back to your KSAT console. In the <strong>Primary Domain</strong> field, paste your <strong>Primary domain</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.us-east-1.amazonaws.com/security_coach/vendor_integrations/Microsoft365_PrimaryDomain.png'><img src='https://helpimg.s3.us-east-1.amazonaws.com/security_coach/vendor_integrations/Microsoft365_PrimaryDomain.png' alt=' '></a></p>\n</li>\n<li>To get your Application (Client) ID, navigate to your Microsoft Azure portal. Select <strong>App registrations</strong> and click on the registered application you created for Microsoft 365 or MCAS in the <a href='#h_01HER1JAAPC4Y4SD3B0NQ51CKG'>Register the SecurityCoach Application</a> section of this article.</li>\n<li>On the application\u2019s overview page, copy the <strong>Application (client) ID</strong> in the <strong>Essentials</strong> section at the top of the page.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_applicationid.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_applicationid.png' alt=' '></a></p>\n</li>\n<li>Navigate back to your KSAT console. In the <strong>Application</strong> (<strong>Client) ID</strong> field, paste your <strong>Application (client) ID</strong>.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.us-east-1.amazonaws.com/security_coach/vendor_integrations/Microsoft365_ApplicationClientID.png'><img src='https://helpimg.s3.us-east-1.amazonaws.com/security_coach/vendor_integrations/Microsoft365_ApplicationClientID.png' alt=' '></a></p>\n</li>\n<li>In the <strong>Client Secret Value</strong> field, enter the <strong>Value</strong> from the client secret that you created in the <a href='#h_01GB31Y8QMDJ1QWR14YT9C8KTV'>Create a Client Secret</a> section above.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.us-east-1.amazonaws.com/security_coach/vendor_integrations/Microsoft365_ClientSecretValue.png'><img src='https://helpimg.s3.us-east-1.amazonaws.com/security_coach/vendor_integrations/Microsoft365_ClientSecretValue.png' alt=' '></a></p>\n</li>\n<li>In the <strong>Token Expiration Date</strong> field, select the <strong>Expires</strong> date for the client secret that you created in the <a href='#h_01GB31Y8QMDJ1QWR14YT9C8KTV'>Create a Client Secret</a> section above.\n<p><a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_tokenexpirationdate.png'><img src='https://helpimg.s3.amazonaws.com/security_coach/vendor_integrations/microsoft_tokenexpirationdate.png' alt=' '></a></p>\n</li>\n<li>To finish setting up the integration, click <strong>Connect</strong>.</li>\n</ol>\n<p>Once you\u2019ve successfully authorized this integration, you can manage detection rules for Microsoft 365 or MCAS on the <strong>Detection Rules</strong> subtab of SecurityCoach. For a full list of available system detection rules for this vendor, see our <a href='https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/11167145735955.html'>Which Detection Rules Can I Use with My Vendors?</a> article.</p>",
    "user_segment_ids": [],
    "source_url": "https://support.knowbe4.com/hc/en-us/articles/6676302311443-Microsoft-365-and-Microsoft-Defender-for-Cloud-Apps-Integration-Guide-for-SecurityCoach"
  }
}