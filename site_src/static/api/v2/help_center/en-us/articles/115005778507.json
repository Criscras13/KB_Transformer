{
  "article": {
    "id": 115005778507,
    "url": "https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/115005778507.json",
    "html_url": "https://Criscras13.github.io/KB_Transformer/api/v2/help_center/en-us/articles/115005778507.html",
    "author_id": 19816382208,
    "comments_disabled": true,
    "draft": false,
    "promoted": false,
    "position": 6,
    "vote_sum": 2,
    "vote_count": 4,
    "section_id": 26412396901011,
    "created_at": "2017-04-14T15:16:23Z",
    "updated_at": "2025-05-27T14:59:25Z",
    "name": "Import Users from Active Directory Using PowerShell",
    "title": "Import Users from Active Directory Using PowerShell",
    "source_locale": "en-us",
    "locale": "en-us",
    "outdated": false,
    "outdated_locales": [],
    "edited_at": "2024-04-25T18:54:36Z",
    "user_segment_id": null,
    "permission_group_id": 195648,
    "content_tag_ids": [],
    "label_names": [
      "ad",
      "export",
      "active directory",
      "powershell",
      "exporting",
      "active",
      "directory",
      "power shell",
      "active directory integration",
      "answerbot",
      "localizing",
      "answerbot_kmsat"
    ],
    "body": "<p>The easiest and most efficient way to integrate users from Active Directory to your KnowBe4 console is to use our <strong>Active Directory Integration</strong> (ADI) feature. For more information on this feature, see our <a href='https://support.knowbe4.com/hc/en-us/articles/228373888'>ADI Configuration Guide</a>.</p>\n<p>If you prefer to manually integrate your Active Directory information, you can use PowerShell to export your user data as a CSV file. Once the CSV file is exported, import your users by following the instructions in our article titled <a href='https://support.knowbe4.com/hc/en-us/articles/204873347'>How Do I Import Users With a CSV File?</a>\u00a0</p>\n<h2 id='h_01HQNN5TYQ8JVRTQMRT8T1S392'>Export Emails Using PowerShell</h2>\n<p>If you would like to add all of your Active Directory users to your KnowB4 console, follow the steps below.\u00a0</p>\n<ol role='list'>\n<li>Open PowerShell in Administrator Mode.</li>\n<li>Run the following command to import the Active Directory Module:<code>Import-Module ActiveDirectory</code>\n</li>\n<li>Next, run the following command to generate a CSV file of all enabled users. The generated CSV file will include each user\u2019s email address, first name, last name, and OU (Organizational Unit).<code>Get-ADUser -Properties * -Filter {Enabled -eq 'True'} | Select-Object @{Label = \"Email\";Expression = {$_.EmailAddress}}, @{Label = \"First Name\";Expression = {$_.GivenName}}, @{Label = \"Last Name\";Expression = {$_.Surname}}, @{Label = \"Group\";Expression = {($_.canonicalname -Split \"/\")[-2]}} | Export-Csv -Path users.csv -NoTypeInformation</code><a href='https://s3.amazonaws.com/helpimg/users%20and%20groups/powershell/export-all-users.ps1'>Click here</a> to download a sample script.</li>\n</ol>\n<div class='code'>\n<p>Once the CSV file is generated, review the file for accuracy. Then, view our article titled <a href='https://support.knowbe4.com/hc/en-us/articles/204873347'>How Do I Import Users With a CSV File?</a> to learn how to add these users to your KnowBe4 console.</p>\n</div>\n<h2 id='h_01HQNN5TYR71RPXBJZ0BQVDT4P'>Export Users Based on Specific Criteria</h2>\n<p>You can also use PowerShell to export a list of users who fit specific criteria. This allows you to only import those specific users to your KnowBe4 console. Below are three common use cases for criteria-based user lists. Click on a use case to learn more and to view sample commands.</p>\n<ul class='js-toggles' role='list'>\n<li title='Generate a List of Users from a Specific Security Group'>\n<p>To export a list of users who belong to a specific security group in Active Directory, follow the steps below.\u00a0</p>\n<ol role='list'>\n<li>Open PowerShell in Administrator Mode.</li>\n<li>Run the following command to import the Active Directory Module:<code>Import-Module ActiveDirectory</code>\n</li>\n<li>Next, enter the following command and change <strong>*ExampleSecurityGroup*</strong> to the specific security group in your Active Directory.<code>Get-ADUser -Properties * -Filter {Enabled -eq 'True'} | Where-Object {($_.memberof -like \"*<strong>ExampleSecurityGroup</strong>*\")} | Select-Object @{Label = \"Email\";Expression = {$_.EmailAddress}}, @{Label = \"First Name\";Expression = {$_.GivenName}}, @{Label = \"Last Name\";Expression = {$_.Surname}}, @{Label = \"Group\";Expression = {($_.canonicalname -Split \"/\")[-2]}} | Export-Csv -Path users.csv -NoTypeInformation</code>\n</li>\n</ol>\n<p><a href='https://s3.amazonaws.com/helpimg/users%20and%20groups/powershell/export-security-group.ps1'>Click here</a> to download a sample script.</p>\n<p>Once the CSV file is generated, review the file for accuracy. Then, view our article titled <a href='https://support.knowbe4.com/hc/en-us/articles/204873347'>How Do I Import Users With a CSV File?</a> to learn how to add these users to your KnowBe4 console. \u00a0</p>\n</li>\n<li title='Generate a List of Users within a Specific OU'>\n<p>To export a list of users within a specific OU (Organizational Unit), follow the steps below.\u00a0</p>\n<ol role='list'>\n<li>Open PowerShell in Administrator Mode.</li>\n<li>Run the following command to import the Active Directory Module:<code>Import-Module ActiveDirectory</code>\n</li>\n<li>Next, enter the following command and change <strong>OU=ExampleOU, DC=Domain, DC=com</strong> to the specific information for your Active Directory.<code>Get-ADUser -Properties * -Filter {Enabled -eq 'True'} -SearchBase \"<strong>OU=ExampleOU, DC=Domain, DC=com</strong>\" | Select-Object @{Label = \"Email\";Expression = {$_.EmailAddress}}, @{Label = \"First Name\";Expression = {$_.GivenName}}, @{Label = \"Last Name\";Expression = {$_.Surname}}, @{Label = \"Group\";Expression = {($_.canonicalname -Split \"/\")[-2]}} | Export-Csv -Path users.csv -NoTypeInformation</code>\n</li>\n</ol>\n<p><a href='https://s3.amazonaws.com/helpimg/users%20and%20groups/powershell/export-organizational-unit.ps1'>Click here</a> to download a sample script.</p>\n<p>Once the CSV file is generated, review the file for accuracy. Then, view our article titled <a href='https://support.knowbe4.com/hc/en-us/articles/204873347'>How Do I Import Users With a CSV File?</a> to learn how to add these users to your KnowBe4 console.\u00a0</p>\n</li>\n<li title='Generate a List of Users from a Specific Distribution Group'>\n<p>To export a list of users who belong to a specific distribution group in Active Directory, follow the steps below.\u00a0</p>\n<ol role='list'>\n<li>Open PowerShell in Administrator Mode.</li>\n<li>Run the following command to import the Active Directory Module:<code>Import-Module ActiveDirectory</code>\n</li>\n<li>Next, enter the following command and change <strong>ExampleDistributionGroup</strong> to the specific distribution group in your Active Directory.<code>$Members = Get-ADGroupMember -Recursive \"<strong>ExampleDistributionGroup</strong>\"$Obj = @()ForEach ($Member in $Members){$User = Get-ADUser -Filter {Name -eq $Member.name -and Enabled -eq 'True'} -Properties *$GroupObj = New-Object PSObject$GroupObj | Add-Member -MemberType NoteProperty -Name \"Email\" -Value $User.EmailAddress$GroupObj | Add-Member -MemberType NoteProperty -Name \"First Name\" -Value $User.GivenName$GroupObj | Add-Member -MemberType NoteProperty -Name \"Last Name\" -Value $User.Surname$GroupObj | Add-Member -MemberType NoteProperty -Name \"Group\" -Value (($User.canonicalname -Split \"/\")[-2])$Obj += $GroupObj}$Obj | Export-Csv users.csv -NoTypeInformation</code>\n</li>\n</ol>\n<p><a href='https://s3.amazonaws.com/helpimg/users%20and%20groups/powershell/export-distribution-group.ps1'>Click here</a> to download a sample script.</p>\n<p>Once the CSV file is generated, review the file for accuracy. Then, view our article titled <a href='https://support.knowbe4.com/hc/en-us/articles/204873347'>How Do I Import Users With a CSV File?</a> to learn how to add these users to your KnowBe4 console.\u00a0\u00a0</p>\n</li>\n</ul>",
    "user_segment_ids": [],
    "source_url": "https://support.knowbe4.com/hc/en-us/articles/115005778507-Import-Users-from-Active-Directory-Using-PowerShell"
  }
}