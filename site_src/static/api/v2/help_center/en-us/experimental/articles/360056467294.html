<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Article 360056467294</title>
</head>
<body>
    <pre>{
  "id": 360056467294,
  "url": "https://Criscras13.github.io/KB_Transformer/site_src/static/api/v2/help_center/en-us/experimental/articles/360056467294.json",
  "html_url": "https://Criscras13.github.io/KB_Transformer/site_src/static/api/v2/help_center/en-us/experimental/articles/360056467294.html",
  "author_id": 403968826754,
  "comments_disabled": true,
  "draft": false,
  "promoted": false,
  "position": 3,
  "vote_sum": 2,
  "vote_count": 4,
  "section_id": 26245163158547,
  "created_at": "2020-10-28T15:29:22Z",
  "updated_at": "2025-03-11T17:32:03Z",
  "name": "FAQ: Direct Message Injection (DMI)",
  "title": "FAQ: Direct Message Injection (DMI)",
  "source_locale": "en-us",
  "locale": "en-us",
  "outdated": false,
  "outdated_locales": [],
  "edited_at": "2025-03-11T17:32:03Z",
  "user_segment_id": null,
  "permission_group_id": 195648,
  "content_tag_ids": [],
  "label_names": [
    "FAQ",
    "direct message injection",
    "dmi",
    "DMI FAQ",
    "answerbot",
    "external banner",
    "external sender",
    "answerbot_kmsat"
  ],
  "body": "<div class='callout-remember'>\n<div class='callout__content'>\n<strong>Note:</strong>In February 2025, Microsoft is retiring the Application Impersonation admin role used by our Microsoft DMI connection. This change will affect your DMI connections and cause them to break. If you currently use DMI as your whitelisting method, we recommend you update your whitelisting to use <a href='https://support.knowbe4.com/hc/en-us/articles/4404511190803'>advanced delivery policies</a>.</div>\n</div>\n<p>In this article, you can find frequently asked questions about our Direct Message Injection (DMI) feature. DMI creates a connection between your KSAT console and your Microsoft 365 or Google Workspace account, which allows our emails to reach your users' inboxes.</p>\n<p>For more information about DMI, see our <a href='https://support.knowbe4.com/hc/en-us/articles/360054494394-DMI-Configuration-Guide'>Direct Message Injection (DMI) Configuration Guide</a>. If you have additional questions that this article doesn't include, contact our <a href='https://support.knowbe4.com/hc/en-us/requests/new'>support team</a>.</p>\n<h2 id='h_01HER1GNFJHAP4XMVK612280RZ'>1. What are the permission requirements for Microsoft 365?</h2>\n<p>For an explanation of each permission requirement for Microsoft 365, see the screenshot and list below:<a data-fancybox='single' data-src='https://helpimg.s3.amazonaws.com/KMSAT/Account_Settings/DMI/DMIPermissionsExtended+-+Lettered+List.png'><img src='https://helpimg.s3.amazonaws.com/KMSAT/Account_Settings/DMI/DMIPermissionsExtended+-+Lettered+List.png' alt=' ' width='350' height='545'></a></p>\n<ol role='list' type='a'>\n<li>\n<strong>Access mailboxes as the signed-in user via Exchange Web Services</strong>: This permission allows DMI to directly access users\u2019 inboxes.</li>\n<li>\n<strong>Use Exchange Web Services with full access to all mailboxes</strong>: This permission allows DMI to write to any of the inboxes in your Microsoft 365 account. DMI will only place emails into inboxes that use the domains listed in the <strong>Direct Message Injection (DMI)</strong> section of your KSAT <strong>Account Settings</strong>. You can also set mailbox limits for your Microsoft 365 account. For more information, see Microsoft's <a href='https://docs.microsoft.com/en-us/graph/auth-limit-mailbox-access'>Limiting application permissions to specific Exchange Online mailboxes</a> article.</li>\n<li>\n<strong>Manage Exchange As Application</strong>: This permission allows DMI to run the inboxes in your Microsoft 365 account without action from users or admins.</li>\n<li>\n<strong>Sign in and read user profile</strong>: This permission allows DMI to see basic user information, such as whether or not users are using multiple email addresses.</li>\n</ol>\n<h2 id='h_01HER1GNFJCJABD6TB7PQCW3QQ'>2. What are the permission requirements for Google Workspace?</h2>\n<p>To connect DMI to your Google Workspace account with domain-wide delegation, you will need to have the Google Workspace <strong>Super Admin</strong> role. To learn more about the Super Admin role, see Google\u2019s <a href='https://support.google.com/a/answer/2405986?hl=en#:~:text=Super%20administrators%20also%20have%20full,calendar%20privileges%20to%20be%20available.&amp;text=Create%20and%20assign%20administrator%20roles,delegated%20admins%2C%20including%20changing%20passwords.'>Pre-built administrator roles</a> article.</p>\n<h2 id='h_01HER1GNFJB1JASQ1QW73T46P8'>3. How do I disable DMI in Microsoft 365?</h2>\n<p>If you no longer have access to your KSAT account and would like to disconnect DMI from Microsoft 365, follow the steps below:</p>\n<ol role='list'>\n<li>Log in to your Microsoft Azure portal.</li>\n<li>Navigate to <strong>Microsoft Entra ID</strong>.</li>\n<li>From the navigation panel, select <strong>Enterprise Applications</strong>.</li>\n<li>In the list that displays, select <strong>KnowBe4 Direct Message Injection</strong>. When you select this option, an overview page will open.</li>\n<li>From the menu on the left, select <strong>Properties</strong>.</li>\n<li>Click the <strong>Delete</strong> button at the top of the page.</li>\n</ol>\n<p>If you have access to your KSMAT account, you can disable DMI by following the steps listed in the <a href='https://support.knowbe4.com/hc/en-us/articles/360054494394-DMI-Configuration-Guide#DISCONNECT'>Disconnect a DMI Connection</a> section of our <a href='https://support.knowbe4.com/hc/en-us/articles/360054494394-DMI-Configuration-Guide'>Direct Message Injection (DMI) Configuration Guide</a>.</p>\n<h2 id='h_01HER1GNFJ6C8PB10EH4J1M16N'>4. How do I disable DMI in Google Workspace?</h2>\n<p>If you no longer have access to your KSAT account and would like to disconnect DMI from Google Workspace, follow the steps below:</p>\n<ol role='list'>\n<li>Log in to your <a href='http://admin.google.com'>Google Workspace Admin console</a>.</li>\n<li>Select the <strong>Security</strong> section of the page.</li>\n<li>Click <strong>Overview</strong>.</li>\n<li>Select the <strong>API controls</strong> section.</li>\n<li>In the <strong>Domain wide delegation</strong> section, click the <strong>Manage Domain Wide Delegation</strong> button.</li>\n<li>Select the connection you created for DMI.</li>\n<li>Click the <strong>Remove</strong> button.</li>\n</ol>\n<p>If you have access to your KSMAT account, you can disable DMI by following the steps listed in the <a href='https://support.knowbe4.com/hc/en-us/articles/360054494394-DMI-Configuration-Guide#DISCONNECT'>Disconnect a DMI Connection</a> section of our <a href='https://support.knowbe4.com/hc/en-us/articles/360054494394-DMI-Configuration-Guide'>Direct Message Injection (DMI) Configuration Guide</a>.</p>\n<h2 id='h_01HER1GNFJYVF4EAK69YYCZY0N'>5. Why isn\u2019t my external sender banner showing on phishing emails sent via DMI?</h2>\n<p>Since DMI connects directly to your Microsoft 365 account, any filters you\u2019ve added for external emails will not apply to emails that are delivered with DMI. This means that the external sender banner will not be applied to our phishing emails.</p>\n<p>To use our placeholders to add banners and subject lines back to our phishing emails, follow the steps below:</p>\n<ol role='list'>\n<li>Log in to your KSAT console.</li>\n<li>Click your email in the top-right corner of the page and select <strong>Account Settings</strong>.</li>\n<li>Under <strong>Account Information</strong>, navigate to the <strong>Branding</strong> section.</li>\n<li>Click the <strong>+ Placeholders</strong> button.</li>\n<li>Add an email banner prefix by following the steps in the list below:</li>\n<ol role='list' type='a'>\n<li>From the <strong>Select a Placeholder to Edit</strong> drop-down menu, select <strong>Email Banner [[email_banner]]</strong>.</li>\n<li>Enter your banner information into the field. You can enter any text in this field, including source code from an existing email banner.</li>\n<li>From the <strong>Select which phishing emails you want the banner to automatically appear on</strong> drop-down menu, select the types of emails you would like the placeholder to automatically apply to. If you would like for the external sender banner to only display on emails delivered with DMI, select <strong>Apply to All Phishing DMI Emails</strong>.</li>\n<li>Click the <strong>Save Placeholders</strong> button.</li>\n</ol>\n<li>(Optional) Add a prefix placeholder by following the steps in the list below:</li>\n<ol role='list' type='a'>\n<li>From the <strong>Select a Placeholder to Edit</strong> drop-down menu, select <strong>Subject Prefix [[subject_prefix]]</strong>.</li>\n<li>Enter the text for the subject of your emails into the field.</li>\n<li>From the <strong>Select which phishing emails you want the banner to automatically appear on</strong> drop-down menu, select the phishing emails that you would like the subject prefix to apply to automatically. If you would like for the subject prefix to only display on emails delivered with DMI, select <strong>Apply to All Phishing DMI Emails</strong>.</li>\n<li>Click the <strong>Save Placeholders</strong> button.</li>\n</ol>\n<li>Click the <strong>Save Changes</strong> button.</li>\n</ol>\n<h2 id='h_01HER1GNFJFZ4EXQE14HRPKQD1'>6. How do I fix a failed connection in Microsoft 365?</h2>\n<p>If the Exchange Web Service token connecting your KSAT console and your Microsoft 365 account becomes invalid, your DMI connection will fail. If the DMI connection fails, any phishing campaign emails that are scheduled to be delivered with DMI will not be sent.</p>\n<p>To reconnect your Microsoft 365 account, see the <a href='https://support.knowbe4.com/hc/en-us/articles/360054494394-Direct-Message-Injection-DMI-Configuration-Guide#FAILED'>How to Fix a Failed Connection in Microsoft 365</a> section of our <a href='https://support.knowbe4.com/hc/en-us/articles/360054494394-Direct-Message-Injection-DMI-Configuration-Guide'>Direct Message Injection (DMI) Configuration Guide</a>.</p>\n<h2 id='h_01HER1GNFJ9GN0NHXDYHKBHQ00'>7. How do I fix a connection error in Google Workspace?</h2>\n<p>If you receive an error after you click the <strong>Authorize</strong> button when connecting DMI to Google Workspace, your client ID and scopes may be incorrect.</p>\n<p>To check your client ID and scopes, follow the steps in the <a href='https://support.knowbe4.com/hc/en-us/articles/360054494394-Direct-Message-Injection-DMI-Configuration-Guide#DELEGATION'>How to Fix a Connection Error in Google Workspace</a> section of our <a href='https://support.knowbe4.com/hc/en-us/articles/360054494394-Direct-Message-Injection-DMI-Configuration-Guide'>Direct Message Injection (DMI) Configuration Guide</a>.</p>\n<h2 id='h_01HER1GNFJ0XZJG9455JNBY783'>8. How do I stop DMI emails from showing in the Other inbox in Microsoft 365?</h2>\n<p>If your users are seeing emails sent with DMI in their <strong>Other</strong> inbox instead of their <strong>Focused</strong> inbox, by following the steps in the <a href='https://support.knowbe4.com/hc/en-us/articles/360054494394-Direct-Message-Injection-DMI-Configuration-Guide#OTHER'>How to Stop DMI Emails from Showing in the Other Inbox in Microsoft 365</a> section of our <a href='https://support.knowbe4.com/hc/en-us/articles/360054494394-Direct-Message-Injection-DMI-Configuration-Guide'>Direct Message Injection (DMI) Configuration Guide</a>.</p>\n<h2 id='h_01HER1GNFJC8D5PDZ6WRDD14B1'>9. How do I add banners, prefixes, and signatures to phishing emails?</h2>\n<p>When DMI is enabled, our phishing emails can bypass all mail flow rules, which may include banners, prefixes, and signatures that display on inbound emails.</p>\n<p>To use our placeholders to add banners, prefixes, and signatures back to our phishing emails, follow the steps in the <a href='https://support.knowbe4.com/hc/en-us/articles/360054494394#PLACEHOLDER'>How to Add Banners, Prefixes, and Signatures to Phishing Emails</a> section of our <a href='https://support.knowbe4.com/hc/en-us/articles/360054494394-Direct-Message-Injection-DMI-Configuration-Guide'>Direct Message Injection (DMI) Configuration Guide</a>.</p>",
  "user_segment_ids": [],
  "source_url": "https://support.knowbe4.com/hc/en-us/articles/360056467294-FAQ-Direct-Message-Injection-DMI",
  "images": [
    {
      "url": "https://helpimg.s3.amazonaws.com/KMSAT/Account_Settings/DMI/DMIPermissionsExtended+-+Lettered+List.png",
      "alt": "A technical description of the image follows:\n\nThis image displays a list of four application permissions requested by an unnamed application, presumably within a security or authentication context (evidenced by the mention of \"Knowbe4\"). The title is: **\"This app would like to:\"** The listed permissions (a, b, c, d) are presented as bulleted items, each marked with an orange circular icon containing a lowercase letter.\n\n**Permission List (a-d):**\n\n*   **a) Access mailboxes as the signed-in user via Exchange Web Services**\n    *   **Description:** Allows the app to have the same access to mailboxes as the signed-in user via Exchange Web Services.\n    *   **Context:** This is a permission requested to access your data in Knowbe4.\n\n*   **b) Use Exchange Web Services with full access to all mailboxes**\n    *   **Description:** Allows the app to have full access via Exchange Web Services to all mailboxes without a signed-in user.\n    *   **Context:** This is a permission requested to access your data in Knowbe4.\n\n*   **c) Manage Exchange As Application**\n    *   **Description:** Allows the app to manage the organization's Exchange environment without any user interaction. This includes mailboxes, groups, and other configuration objects. To enable management actions, an admin must assign the appropriate roles directly to the app.\n    *   **Context:** This is a permission requested to access your data in Knowbe4.\n\n*   **d) Sign in and read user profile**\n    *   **Description:** Allows users to sign-in to the app, and allows the app to read the profile of signed-in users. It also allows the app to read basic company information of signed-in users.\n    *   **Context:** This is a permission requested to access your data in Knowbe4.\n\nThe text is standard black sans-serif font against a white background. The overall presentation suggests a configuration or consent screen detailing required application privileges, primarily focused on Microsoft Exchange and user data access.",
      "position": 1,
      "context": "rement for Microsoft 365, see the screenshot and list below:"
    }
  ],
  "metadata": {
    "category": "",
    "section": "",
    "topics": [
      "direct",
      "dmi",
      "faq",
      "injection"
    ],
    "image_count": 1
  }
}</pre>
</body>
</html>